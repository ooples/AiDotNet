<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class GradientPruningStrategy&lt;T&gt; | AiDotNet Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class GradientPruningStrategy&lt;T&gt; | AiDotNet Documentation ">
      
      <meta name="description" content="Prunes weights based on gradient magnitude (sensitivity).">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ooples/AiDotNet/new/master/apiSpec/new?filename=AiDotNet_Pruning_GradientPruningStrategy_1.md&amp;value=---%0Auid%3A%20AiDotNet.Pruning.GradientPruningStrategy%601%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="AiDotNet">
            AiDotNet
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="AiDotNet.Pruning.GradientPruningStrategy`1">



  <h1 id="AiDotNet_Pruning_GradientPruningStrategy_1" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1" class="text-break">
Class GradientPruningStrategy&lt;T&gt;  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L34"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="AiDotNet.html">AiDotNet</a>.<a class="xref" href="AiDotNet.Pruning.html">Pruning</a></dd></dl>
  <dl><dt>Assembly</dt><dd>AiDotNet.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Prunes weights based on gradient magnitude (sensitivity).</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class GradientPruningStrategy&lt;T&gt; : IPruningStrategy&lt;T&gt;</code></pre>
  </div>



  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type used for calculations (e.g., float, double).</p>
</dd>
  </dl>

  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">GradientPruningStrategy&lt;T&gt;</span></div>
    </dd>
  </dl>

  <dl class="typelist implements">
    <dt>Implements</dt>
    <dd>
      <div><a class="xref" href="AiDotNet.Interfaces.IPruningStrategy-1.html">IPruningStrategy</a>&lt;T&gt;</div>
    </dd>
  </dl>


  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>




  <h2 id="AiDotNet_Pruning_GradientPruningStrategy_1_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p>
Gradient-based pruning uses gradient information to determine weight importance.
Weights with small gradients have little impact on the loss function and can be safely removed.
This approach considers both the weight value and how much it affects learning.
</p>
<p><b>For Beginners:</b> This strategy removes connections that don't learn much.
<p>Think of it like identifying which team members contribute to a project:</p>
<ul>
<li>High gradient = This weight changes a lot during training, it's learning something important</li>
<li>Low gradient = This weight barely changes, it's not contributing much to learning</li>
</ul>
<p>The importance score is calculated as |weight × gradient|:</p>
<ul>
<li>If a weight is large BUT has tiny gradients, it might not be doing much</li>
<li>If a weight is learning slowly (small gradient), removing it won't hurt performance</li>
</ul>
<p>This is smarter than magnitude-based pruning because it considers learning dynamics,
not just weight size. However, it requires gradient information from training.</p>
<p>Example:</p>
<ul>
<li>Weight = 0.5, Gradient = 0.001 → Importance = |0.5 × 0.001| = 0.0005 (low, prune it)</li>
<li>Weight = 0.3, Gradient = 0.9 → Importance = |0.3 × 0.9| = 0.27 (high, keep it)</li>
</ul>

</div>


  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="AiDotNet_Pruning_GradientPruningStrategy_1__ctor_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.#ctor*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1__ctor" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.#ctor">
  GradientPruningStrategy()
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L66"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Initializes a new instance of GradientPruningStrategy.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public GradientPruningStrategy()</code></pre>
  </div>













  <h2 class="section" id="properties">Properties
</h2>


  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_IsStructured_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.IsStructured*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_IsStructured" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.IsStructured">
  IsStructured
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L46"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets whether this is structured pruning (false for gradient-based).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool IsStructured { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd></dd>
  </dl>








  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_Name_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.Name*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_Name" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.Name">
  Name
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L51"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets the name of this pruning strategy.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public string Name { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd></dd>
  </dl>








  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_RequiresGradients_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.RequiresGradients*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_RequiresGradients" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.RequiresGradients">
  RequiresGradients
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L41"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets whether this strategy requires gradients (true for gradient-based).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool RequiresGradients { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd></dd>
  </dl>








  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_SupportedPatterns_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.SupportedPatterns*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_SupportedPatterns" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.SupportedPatterns">
  SupportedPatterns
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L56"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets supported sparsity patterns.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public IReadOnlyList&lt;SparsityPattern&gt; SupportedPatterns { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.ireadonlylist-1">IReadOnlyList</a>&lt;<a class="xref" href="AiDotNet.Interfaces.SparsityPattern.html">SparsityPattern</a>&gt;</dt>
    <dd></dd>
  </dl>








  <h2 class="section" id="methods">Methods
</h2>


  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_ApplyPruning_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ApplyPruning*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_ApplyPruning_AiDotNet_Tensors_LinearAlgebra_Matrix__0__AiDotNet_Interfaces_IPruningMask__0__" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ApplyPruning(AiDotNet.Tensors.LinearAlgebra.Matrix{`0},AiDotNet.Interfaces.IPruningMask{`0})">
  ApplyPruning(Matrix&lt;T&gt;, IPruningMask&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L358"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Applies the pruning mask to weights in-place.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void ApplyPruning(Matrix&lt;T&gt; weights, IPruningMask&lt;T&gt; mask)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>weights</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Matrix-1.html">Matrix</a>&lt;T&gt;</dt>
    <dd><p>Weight matrix to prune</p>
</dd>
    <dt><code>mask</code> <a class="xref" href="AiDotNet.Interfaces.IPruningMask-1.html">IPruningMask</a>&lt;T&gt;</dt>
    <dd><p>Pruning mask to apply</p>
</dd>
  </dl>








  <h4 class="section" id="AiDotNet_Pruning_GradientPruningStrategy_1_ApplyPruning_AiDotNet_Tensors_LinearAlgebra_Matrix__0__AiDotNet_Interfaces_IPruningMask__0___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This actually removes the weights by setting them to zero.
The pruned weights are those identified as having low gradient-based importance.
</p>
</div>




  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_ApplyPruning_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ApplyPruning*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_ApplyPruning_AiDotNet_Tensors_LinearAlgebra_Tensor__0__AiDotNet_Interfaces_IPruningMask__0__" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ApplyPruning(AiDotNet.Tensors.LinearAlgebra.Tensor{`0},AiDotNet.Interfaces.IPruningMask{`0})">
  ApplyPruning(Tensor&lt;T&gt;, IPruningMask&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L372"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Applies pruning mask to tensor weights in-place.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void ApplyPruning(Tensor&lt;T&gt; weights, IPruningMask&lt;T&gt; mask)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>weights</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>Weight tensor to prune</p>
</dd>
    <dt><code>mask</code> <a class="xref" href="AiDotNet.Interfaces.IPruningMask-1.html">IPruningMask</a>&lt;T&gt;</dt>
    <dd><p>Pruning mask to apply</p>
</dd>
  </dl>












  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_ApplyPruning_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ApplyPruning*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_ApplyPruning_AiDotNet_Tensors_LinearAlgebra_Vector__0__AiDotNet_Interfaces_IPruningMask__0__" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ApplyPruning(AiDotNet.Tensors.LinearAlgebra.Vector{`0},AiDotNet.Interfaces.IPruningMask{`0})">
  ApplyPruning(Vector&lt;T&gt;, IPruningMask&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L340"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Applies pruning mask to vector weights in-place.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void ApplyPruning(Vector&lt;T&gt; weights, IPruningMask&lt;T&gt; mask)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>weights</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>Weight vector to prune</p>
</dd>
    <dt><code>mask</code> <a class="xref" href="AiDotNet.Interfaces.IPruningMask-1.html">IPruningMask</a>&lt;T&gt;</dt>
    <dd><p>Pruning mask to apply</p>
</dd>
  </dl>












  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_ComputeImportanceScores_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ComputeImportanceScores*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_ComputeImportanceScores_AiDotNet_Tensors_LinearAlgebra_Matrix__0__AiDotNet_Tensors_LinearAlgebra_Matrix__0__" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ComputeImportanceScores(AiDotNet.Tensors.LinearAlgebra.Matrix{`0},AiDotNet.Tensors.LinearAlgebra.Matrix{`0})">
  ComputeImportanceScores(Matrix&lt;T&gt;, Matrix&lt;T&gt;?)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L112"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Computes importance scores as the product of weight magnitude and gradient magnitude.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public Matrix&lt;T&gt; ComputeImportanceScores(Matrix&lt;T&gt; weights, Matrix&lt;T&gt;? gradients = null)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>weights</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Matrix-1.html">Matrix</a>&lt;T&gt;</dt>
    <dd><p>Weight matrix</p>
</dd>
    <dt><code>gradients</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Matrix-1.html">Matrix</a>&lt;T&gt;</dt>
    <dd><p>Gradient matrix (required for this strategy)</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Matrix-1.html">Matrix</a>&lt;T&gt;</dt>
    <dd><p>Matrix of importance scores</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_Pruning_GradientPruningStrategy_1_ComputeImportanceScores_AiDotNet_Tensors_LinearAlgebra_Matrix__0__AiDotNet_Tensors_LinearAlgebra_Matrix__0___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This calculates how important each weight is by looking at both:
1. The weight's value
2. How much the weight is learning (its gradient)
<p>The importance is |weight × gradient|. This tells us how much removing the weight
would affect the model's learning and output.</p>

</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentexception">ArgumentException</a></dt>
    <dd><p>Thrown when gradients are null or shape doesn't match weights</p>
</dd>
  </dl>



  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_ComputeImportanceScores_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ComputeImportanceScores*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_ComputeImportanceScores_AiDotNet_Tensors_LinearAlgebra_Tensor__0__AiDotNet_Tensors_LinearAlgebra_Tensor__0__" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ComputeImportanceScores(AiDotNet.Tensors.LinearAlgebra.Tensor{`0},AiDotNet.Tensors.LinearAlgebra.Tensor{`0})">
  ComputeImportanceScores(Tensor&lt;T&gt;, Tensor&lt;T&gt;?)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L144"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Computes importance scores for tensor weights.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public Tensor&lt;T&gt; ComputeImportanceScores(Tensor&lt;T&gt; weights, Tensor&lt;T&gt;? gradients = null)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>weights</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>Weight tensor.</p>
</dd>
    <dt><code>gradients</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>Gradient tensor (required for gradient-based pruning).</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>Importance score for each weight (higher = more important).</p>
</dd>
  </dl>








  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentexception">ArgumentException</a></dt>
    <dd><p>Thrown when gradients are null or shape doesn't match weights</p>
</dd>
  </dl>



  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_ComputeImportanceScores_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ComputeImportanceScores*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_ComputeImportanceScores_AiDotNet_Tensors_LinearAlgebra_Vector__0__AiDotNet_Tensors_LinearAlgebra_Vector__0__" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ComputeImportanceScores(AiDotNet.Tensors.LinearAlgebra.Vector{`0},AiDotNet.Tensors.LinearAlgebra.Vector{`0})">
  ComputeImportanceScores(Vector&lt;T&gt;, Vector&lt;T&gt;?)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L78"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Computes importance scores for vector weights.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public Vector&lt;T&gt; ComputeImportanceScores(Vector&lt;T&gt; weights, Vector&lt;T&gt;? gradients = null)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>weights</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>Weight vector.</p>
</dd>
    <dt><code>gradients</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>Gradient vector (required for gradient-based pruning).</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>Importance score for each weight (higher = more important).</p>
</dd>
  </dl>








  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentexception">ArgumentException</a></dt>
    <dd><p>Thrown when gradients are null or shape doesn't match weights</p>
</dd>
  </dl>



  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_Create2to4Mask_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.Create2to4Mask*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_Create2to4Mask_AiDotNet_Tensors_LinearAlgebra_Tensor__0__" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.Create2to4Mask(AiDotNet.Tensors.LinearAlgebra.Tensor{`0})">
  Create2to4Mask(Tensor&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L297"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Creates a 2:4 structured sparsity mask (NVIDIA Ampere compatible).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public IPruningMask&lt;T&gt; Create2to4Mask(Tensor&lt;T&gt; importanceScores)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>importanceScores</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>Importance scores.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Interfaces.IPruningMask-1.html">IPruningMask</a>&lt;T&gt;</dt>
    <dd><p>2:4 structured mask (exactly 2 zeros per 4 elements).</p>
</dd>
  </dl>











  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_CreateMask_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.CreateMask*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_CreateMask_AiDotNet_Tensors_LinearAlgebra_Matrix__0__System_Double_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.CreateMask(AiDotNet.Tensors.LinearAlgebra.Matrix{`0},System.Double)">
  CreateMask(Matrix&lt;T&gt;, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L218"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Creates a pruning mask by selecting weights with lowest gradient-based importance.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public IPruningMask&lt;T&gt; CreateMask(Matrix&lt;T&gt; importanceScores, double targetSparsity)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>importanceScores</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Matrix-1.html">Matrix</a>&lt;T&gt;</dt>
    <dd><p>Importance scores from ComputeImportanceScores</p>
</dd>
    <dt><code>targetSparsity</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Target sparsity ratio (0 to 1)</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Interfaces.IPruningMask-1.html">IPruningMask</a>&lt;T&gt;</dt>
    <dd><p>Binary mask (1 = keep, 0 = prune)</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_Pruning_GradientPruningStrategy_1_CreateMask_AiDotNet_Tensors_LinearAlgebra_Matrix__0__System_Double__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This creates the mask that decides which weights to remove.
<p>Similar to magnitude pruning, but using gradient-based scores:</p>
<ul>
<li>Weights with low |weight × gradient| scores are pruned</li>
<li>Weights with high scores are kept</li>
</ul>
<p>This tends to preserve weights that are actively contributing to learning.</p>

</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentexception">ArgumentException</a></dt>
    <dd><p>Thrown when targetSparsity is not between 0 and 1</p>
</dd>
  </dl>



  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_CreateMask_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.CreateMask*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_CreateMask_AiDotNet_Tensors_LinearAlgebra_Tensor__0__System_Double_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.CreateMask(AiDotNet.Tensors.LinearAlgebra.Tensor{`0},System.Double)">
  CreateMask(Tensor&lt;T&gt;, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L262"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Creates a pruning mask for tensor weights based on target sparsity.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public IPruningMask&lt;T&gt; CreateMask(Tensor&lt;T&gt; importanceScores, double targetSparsity)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>importanceScores</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>Importance scores from ComputeImportanceScores.</p>
</dd>
    <dt><code>targetSparsity</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Target sparsity ratio (0 to 1).</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Interfaces.IPruningMask-1.html">IPruningMask</a>&lt;T&gt;</dt>
    <dd><p>Binary mask (1 = keep, 0 = prune).</p>
</dd>
  </dl>








  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentexception">ArgumentException</a></dt>
    <dd><p>Thrown when targetSparsity is not between 0 and 1</p>
</dd>
  </dl>



  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_CreateMask_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.CreateMask*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_CreateMask_AiDotNet_Tensors_LinearAlgebra_Vector__0__System_Double_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.CreateMask(AiDotNet.Tensors.LinearAlgebra.Vector{`0},System.Double)">
  CreateMask(Vector&lt;T&gt;, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L172"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Creates a pruning mask for vector weights based on target sparsity.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public IPruningMask&lt;T&gt; CreateMask(Vector&lt;T&gt; importanceScores, double targetSparsity)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>importanceScores</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>Importance scores from ComputeImportanceScores.</p>
</dd>
    <dt><code>targetSparsity</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Target sparsity ratio (0 to 1).</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Interfaces.IPruningMask-1.html">IPruningMask</a>&lt;T&gt;</dt>
    <dd><p>Binary mask (1 = keep, 0 = prune).</p>
</dd>
  </dl>








  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentexception">ArgumentException</a></dt>
    <dd><p>Thrown when targetSparsity is not between 0 and 1</p>
</dd>
  </dl>



  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_CreateNtoMMask_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.CreateNtoMMask*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_CreateNtoMMask_AiDotNet_Tensors_LinearAlgebra_Tensor__0__System_Int32_System_Int32_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.CreateNtoMMask(AiDotNet.Tensors.LinearAlgebra.Tensor{`0},System.Int32,System.Int32)">
  CreateNtoMMask(Tensor&lt;T&gt;, int, int)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L309"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Creates an N:M structured sparsity mask.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public IPruningMask&lt;T&gt; CreateNtoMMask(Tensor&lt;T&gt; importanceScores, int n, int m)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>importanceScores</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>Importance scores.</p>
</dd>
    <dt><code>n</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>Number of zeros per group.</p>
</dd>
    <dt><code>m</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>Group size.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Interfaces.IPruningMask-1.html">IPruningMask</a>&lt;T&gt;</dt>
    <dd><p>N:M structured mask.</p>
</dd>
  </dl>











  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_ToSparseFormat_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ToSparseFormat*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_ToSparseFormat_AiDotNet_Tensors_LinearAlgebra_Tensor__0__AiDotNet_ModelCompression_SparseFormat_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ToSparseFormat(AiDotNet.Tensors.LinearAlgebra.Tensor{`0},AiDotNet.ModelCompression.SparseFormat)">
  ToSparseFormat(Tensor&lt;T&gt;, SparseFormat)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L387"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Converts pruned weights to sparse format for efficient storage.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public SparseCompressionResult&lt;T&gt; ToSparseFormat(Tensor&lt;T&gt; weights, SparseFormat format)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>weights</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>Pruned weights (containing zeros).</p>
</dd>
    <dt><code>format</code> <a class="xref" href="AiDotNet.ModelCompression.SparseFormat.html">SparseFormat</a></dt>
    <dd><p>Target sparse format.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.ModelCompression.SparseCompressionResult-1.html">SparseCompressionResult</a>&lt;T&gt;</dt>
    <dd><p>Sparse representation.</p>
</dd>
  </dl>











  <a id="AiDotNet_Pruning_GradientPruningStrategy_1_ToSparseFormat_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ToSparseFormat*"></a>

  <h3 id="AiDotNet_Pruning_GradientPruningStrategy_1_ToSparseFormat_AiDotNet_Tensors_LinearAlgebra_Tensor__0__AiDotNet_ModelCompression_SparseFormat_System_Int32_System_Int32_" data-uid="AiDotNet.Pruning.GradientPruningStrategy`1.ToSparseFormat(AiDotNet.Tensors.LinearAlgebra.Tensor{`0},AiDotNet.ModelCompression.SparseFormat,System.Int32,System.Int32)">
  ToSparseFormat(Tensor&lt;T&gt;, SparseFormat, int, int)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L537"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Converts pruned weights to N:M structured sparse format for efficient storage.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public SparseCompressionResult&lt;T&gt; ToSparseFormat(Tensor&lt;T&gt; weights, SparseFormat format, int n, int m)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>weights</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>Pruned weights (containing zeros).</p>
</dd>
    <dt><code>format</code> <a class="xref" href="AiDotNet.ModelCompression.SparseFormat.html">SparseFormat</a></dt>
    <dd><p>Target sparse format (should be Structured2to4 or StructuredNtoM).</p>
</dd>
    <dt><code>n</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>Number of zeros per group in N:M sparsity pattern.</p>
</dd>
    <dt><code>m</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>Group size in N:M sparsity pattern.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.ModelCompression.SparseCompressionResult-1.html">SparseCompressionResult</a>&lt;T&gt;</dt>
    <dd><p>Sparse representation with N:M pattern metadata.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_Pruning_GradientPruningStrategy_1_ToSparseFormat_AiDotNet_Tensors_LinearAlgebra_Tensor__0__AiDotNet_ModelCompression_SparseFormat_System_Int32_System_Int32__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> N:M structured sparsity is a special pattern where exactly N elements
out of every M consecutive elements are zero. For example, 2:4 sparsity means 2 zeros per 4 elements.
This is hardware-friendly on NVIDIA Ampere GPUs which have specialized support for 2:4 patterns.
</p>
</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentoutofrangeexception">ArgumentOutOfRangeException</a></dt>
    <dd><p>Thrown when n or m are invalid.</p>
</dd>
  </dl>




</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ooples/AiDotNet/blob/master/src/Pruning/GradientPruningStrategy.cs/#L34" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          AiDotNet - Enterprise AI/ML Library for .NET
        </div>
      </div>
    </footer>
  </body>
</html>
