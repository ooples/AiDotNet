<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class NumericalStabilityHelper | AiDotNet Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class NumericalStabilityHelper | AiDotNet Documentation ">
      
      <meta name="description" content="Provides numerical stability utilities for safe mathematical operations in machine learning.">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ooples/AiDotNet/new/master/apiSpec/new?filename=AiDotNet_Helpers_NumericalStabilityHelper.md&amp;value=---%0Auid%3A%20AiDotNet.Helpers.NumericalStabilityHelper%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="AiDotNet">
            AiDotNet
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="AiDotNet.Helpers.NumericalStabilityHelper">



  <h1 id="AiDotNet_Helpers_NumericalStabilityHelper" data-uid="AiDotNet.Helpers.NumericalStabilityHelper" class="text-break">
Class NumericalStabilityHelper  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L17"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="AiDotNet.html">AiDotNet</a>.<a class="xref" href="AiDotNet.Helpers.html">Helpers</a></dd></dl>
  <dl><dt>Assembly</dt><dd>AiDotNet.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Provides numerical stability utilities for safe mathematical operations in machine learning.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static class NumericalStabilityHelper</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">NumericalStabilityHelper</span></div>
    </dd>
  </dl>



  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>




  <h2 id="AiDotNet_Helpers_NumericalStabilityHelper_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p><b>For Beginners:</b> Machine learning algorithms often deal with very small or very large numbers,
which can cause numerical issues like:
- Division by zero
- Log of zero or negative numbers
- NaN (Not a Number) values appearing in calculations
- Infinity values from overflow
<p>This helper provides safe versions of common operations that avoid these problems.</p>

</div>


  <h2 class="section" id="fields">Fields
</h2>



  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_DefaultEpsilon" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.DefaultEpsilon">
  DefaultEpsilon
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L22"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Default epsilon value for numerical stability (1e-7 for float precision).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public const double DefaultEpsilon = 1E-07</code></pre>
  </div>




  <h4 class="section">Field Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd></dd>
  </dl>










  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_LargeEpsilon" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.LargeEpsilon">
  LargeEpsilon
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L32"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Larger epsilon for less sensitive operations (1e-5).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public const double LargeEpsilon = 1E-05</code></pre>
  </div>




  <h4 class="section">Field Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd></dd>
  </dl>










  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_SmallEpsilon" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.SmallEpsilon">
  SmallEpsilon
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L27"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Smaller epsilon for double precision operations (1e-15).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public const double SmallEpsilon = 1E-15</code></pre>
  </div>




  <h4 class="section">Field Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd></dd>
  </dl>









  <h2 class="section" id="methods">Methods
</h2>


  <a id="AiDotNet_Helpers_NumericalStabilityHelper_AssertFinite_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.AssertFinite*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_AssertFinite__1_AiDotNet_Tensors_LinearAlgebra_Tensor___0__System_String_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.AssertFinite``1(AiDotNet.Tensors.LinearAlgebra.Tensor{``0},System.String)">
  AssertFinite&lt;T&gt;(Tensor&lt;T&gt;, string)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L514"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Asserts that a tensor contains only finite values.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static void AssertFinite&lt;T&gt;(Tensor&lt;T&gt; tensor, string paramName = &quot;tensor&quot;)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>tensor</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>The tensor to check.</p>
</dd>
    <dt><code>paramName</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>Name of the parameter for the exception message.</p>
</dd>
  </dl>


  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>







  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentexception">ArgumentException</a></dt>
    <dd><p>Thrown if the tensor contains non-finite values.</p>
</dd>
  </dl>



  <a id="AiDotNet_Helpers_NumericalStabilityHelper_AssertFinite_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.AssertFinite*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_AssertFinite__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__System_String_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.AssertFinite``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0},System.String)">
  AssertFinite&lt;T&gt;(Vector&lt;T&gt;, string)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L492"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Asserts that a vector contains only finite values.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static void AssertFinite&lt;T&gt;(Vector&lt;T&gt; vector, string paramName = &quot;vector&quot;)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>vector</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The vector to check.</p>
</dd>
    <dt><code>paramName</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>Name of the parameter for the exception message.</p>
</dd>
  </dl>


  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>







  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentexception">ArgumentException</a></dt>
    <dd><p>Thrown if the vector contains non-finite values.</p>
</dd>
  </dl>



  <a id="AiDotNet_Helpers_NumericalStabilityHelper_AssertFinite_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.AssertFinite*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_AssertFinite__1___0_System_String_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.AssertFinite``1(``0,System.String)">
  AssertFinite&lt;T&gt;(T, string)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L477"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Asserts that a value is finite, throwing if not.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static void AssertFinite&lt;T&gt;(T value, string paramName = &quot;value&quot;)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>value</code> <span class="xref">T</span></dt>
    <dd><p>The value to check.</p>
</dd>
    <dt><code>paramName</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>Name of the parameter for the exception message.</p>
</dd>
  </dl>


  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>







  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentexception">ArgumentException</a></dt>
    <dd><p>Thrown if the value is not finite.</p>
</dd>
  </dl>



  <a id="AiDotNet_Helpers_NumericalStabilityHelper_ClampProbability_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ClampProbability*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_ClampProbability__1___0_System_Double_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ClampProbability``1(``0,System.Double)">
  ClampProbability&lt;T&gt;(T, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L125"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Clamps a value to valid probability range [epsilon, 1-epsilon].</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static T ClampProbability&lt;T&gt;(T probability, double epsilon = 1E-07)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>probability</code> <span class="xref">T</span></dt>
    <dd><p>The probability value to clamp.</p>
</dd>
    <dt><code>epsilon</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Small value for bounds. Defaults to 1e-7.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><span class="xref">T</span></dt>
    <dd><p>The clamped probability.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>






  <h4 class="section" id="AiDotNet_Helpers_NumericalStabilityHelper_ClampProbability__1___0_System_Double__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> Probabilities should be between 0 and 1, but for numerical
stability (especially when taking log of probabilities), we clamp to [epsilon, 1-epsilon]
to avoid log(0) and log(1) issues.
</p>
</div>




  <a id="AiDotNet_Helpers_NumericalStabilityHelper_ContainsInfinity_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ContainsInfinity*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_ContainsInfinity__1_AiDotNet_Tensors_LinearAlgebra_Tensor___0__" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ContainsInfinity``1(AiDotNet.Tensors.LinearAlgebra.Tensor{``0})">
  ContainsInfinity&lt;T&gt;(Tensor&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L250"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Checks if a tensor contains any infinite values.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool ContainsInfinity&lt;T&gt;(Tensor&lt;T&gt; tensor)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>tensor</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>The tensor to check.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if any element is infinite.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_ContainsInfinity_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ContainsInfinity*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_ContainsInfinity__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ContainsInfinity``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0})">
  ContainsInfinity&lt;T&gt;(Vector&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L205"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Checks if a vector contains any infinite values.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool ContainsInfinity&lt;T&gt;(Vector&lt;T&gt; vector)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>vector</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The vector to check.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if any element is infinite.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_ContainsNaN_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ContainsNaN*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_ContainsNaN__1_AiDotNet_Tensors_LinearAlgebra_Tensor___0__" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ContainsNaN``1(AiDotNet.Tensors.LinearAlgebra.Tensor{``0})">
  ContainsNaN&lt;T&gt;(Tensor&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L233"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Checks if a tensor contains any NaN values.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool ContainsNaN&lt;T&gt;(Tensor&lt;T&gt; tensor)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>tensor</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>The tensor to check.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if any element is NaN.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_ContainsNaN_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ContainsNaN*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_ContainsNaN__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ContainsNaN``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0})">
  ContainsNaN&lt;T&gt;(Vector&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L188"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Checks if a vector contains any NaN values.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool ContainsNaN&lt;T&gt;(Vector&lt;T&gt; vector)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>vector</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The vector to check.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if any element is NaN.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_ContainsNonFinite_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ContainsNonFinite*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_ContainsNonFinite__1_AiDotNet_Tensors_LinearAlgebra_Tensor___0__" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ContainsNonFinite``1(AiDotNet.Tensors.LinearAlgebra.Tensor{``0})">
  ContainsNonFinite&lt;T&gt;(Tensor&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L267"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Checks if a tensor contains any non-finite values (NaN or infinite).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool ContainsNonFinite&lt;T&gt;(Tensor&lt;T&gt; tensor)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>tensor</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>The tensor to check.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if any element is non-finite.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_ContainsNonFinite_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ContainsNonFinite*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_ContainsNonFinite__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ContainsNonFinite``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0})">
  ContainsNonFinite&lt;T&gt;(Vector&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L222"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Checks if a vector contains any non-finite values (NaN or infinite).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool ContainsNonFinite&lt;T&gt;(Vector&lt;T&gt; vector)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>vector</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The vector to check.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if any element is non-finite.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_CountInfinity_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.CountInfinity*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_CountInfinity__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.CountInfinity``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0})">
  CountInfinity&lt;T&gt;(Vector&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L458"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Counts the number of infinite values in a vector.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static int CountInfinity&lt;T&gt;(Vector&lt;T&gt; vector)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>vector</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The vector to check.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The count of infinite values.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_CountNaN_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.CountNaN*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_CountNaN__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.CountNaN``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0})">
  CountNaN&lt;T&gt;(Vector&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L440"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Counts the number of NaN values in a vector.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static int CountNaN&lt;T&gt;(Vector&lt;T&gt; vector)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>vector</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The vector to check.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The count of NaN values.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_GetEpsilon_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.GetEpsilon*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_GetEpsilon__1_System_Nullable_System_Double__" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.GetEpsilon``1(System.Nullable{System.Double})">
  GetEpsilon&lt;T&gt;(double?)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L40"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets a type-appropriate epsilon value for the numeric type T.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static T GetEpsilon&lt;T&gt;(double? epsilon = null)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>epsilon</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a>?</dt>
    <dd><p>Optional custom epsilon. If null, uses type-appropriate default.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><span class="xref">T</span></dt>
    <dd><p>The epsilon value converted to type T.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_IsFinite_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.IsFinite*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_IsFinite__1___0_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.IsFinite``1(``0)">
  IsFinite&lt;T&gt;(T)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L177"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Checks if a value is finite (not NaN and not infinite).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool IsFinite&lt;T&gt;(T value)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>value</code> <span class="xref">T</span></dt>
    <dd><p>The value to check.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if the value is finite.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_IsInfinity_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.IsInfinity*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_IsInfinity__1___0_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.IsInfinity``1(``0)">
  IsInfinity&lt;T&gt;(T)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L165"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Checks if a value is infinite (positive or negative infinity).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool IsInfinity&lt;T&gt;(T value)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>value</code> <span class="xref">T</span></dt>
    <dd><p>The value to check.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if the value is infinite.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_IsNaN_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.IsNaN*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_IsNaN__1___0_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.IsNaN``1(``0)">
  IsNaN&lt;T&gt;(T)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L153"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Checks if a value is NaN (Not a Number).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool IsNaN&lt;T&gt;(T value)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>value</code> <span class="xref">T</span></dt>
    <dd><p>The value to check.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if the value is NaN.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_ReplaceInfinity_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ReplaceInfinity*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_ReplaceInfinity__1_AiDotNet_Tensors_LinearAlgebra_Vector___0____0_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ReplaceInfinity``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0},``0)">
  ReplaceInfinity&lt;T&gt;(Vector&lt;T&gt;?, T?)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L301"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Replaces infinite values in a vector with a specified replacement value.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static Vector&lt;T&gt;? ReplaceInfinity&lt;T&gt;(Vector&lt;T&gt;? vector, T? replacement = default)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>vector</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The vector to process.</p>
</dd>
    <dt><code>replacement</code> <span class="xref">T</span></dt>
    <dd><p>The value to replace infinity with (defaults to zero).</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>A new vector with infinite values replaced.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_ReplaceNaN_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ReplaceNaN*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_ReplaceNaN__1_AiDotNet_Tensors_LinearAlgebra_Vector___0____0_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ReplaceNaN``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0},``0)">
  ReplaceNaN&lt;T&gt;(Vector&lt;T&gt;?, T?)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L279"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Replaces NaN values in a vector with a specified replacement value.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static Vector&lt;T&gt;? ReplaceNaN&lt;T&gt;(Vector&lt;T&gt;? vector, T? replacement = default)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>vector</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The vector to process.</p>
</dd>
    <dt><code>replacement</code> <span class="xref">T</span></dt>
    <dd><p>The value to replace NaN with (defaults to zero).</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>A new vector with NaN values replaced.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_ReplaceNonFinite_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ReplaceNonFinite*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_ReplaceNonFinite__1_AiDotNet_Tensors_LinearAlgebra_Vector___0____0_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.ReplaceNonFinite``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0},``0)">
  ReplaceNonFinite&lt;T&gt;(Vector&lt;T&gt;?, T?)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L323"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Replaces all non-finite values (NaN and infinity) in a vector.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static Vector&lt;T&gt;? ReplaceNonFinite&lt;T&gt;(Vector&lt;T&gt;? vector, T? replacement = default)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>vector</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The vector to process.</p>
</dd>
    <dt><code>replacement</code> <span class="xref">T</span></dt>
    <dd><p>The value to replace non-finite values with (defaults to zero).</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>A new vector with non-finite values replaced.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_SafeDiv_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.SafeDiv*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_SafeDiv__1___0___0_System_Double_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.SafeDiv``1(``0,``0,System.Double)">
  SafeDiv&lt;T&gt;(T, T, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L81"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Performs safe division, avoiding division by zero.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static T SafeDiv&lt;T&gt;(T numerator, T denominator, double epsilon = 1E-07)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>numerator</code> <span class="xref">T</span></dt>
    <dd><p>The numerator.</p>
</dd>
    <dt><code>denominator</code> <span class="xref">T</span></dt>
    <dd><p>The denominator.</p>
</dd>
    <dt><code>epsilon</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Small value to add to denominator for stability. Defaults to 1e-7.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><span class="xref">T</span></dt>
    <dd><p>numerator / (denominator + epsilon) if denominator is near zero, else numerator / denominator.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>






  <h4 class="section" id="AiDotNet_Helpers_NumericalStabilityHelper_SafeDiv__1___0___0_System_Double__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> Division by zero results in infinity or NaN. This method adds
a tiny value to very small denominators to prevent this while minimally affecting the result.
</p>
</div>




  <a id="AiDotNet_Helpers_NumericalStabilityHelper_SafeLogProbability_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.SafeLogProbability*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_SafeLogProbability__1___0_System_Double_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.SafeLogProbability``1(``0,System.Double)">
  SafeLogProbability&lt;T&gt;(T, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L140"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Computes safe log of a probability (clamps first, then takes log).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static T SafeLogProbability&lt;T&gt;(T probability, double epsilon = 1E-07)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>probability</code> <span class="xref">T</span></dt>
    <dd><p>The probability value.</p>
</dd>
    <dt><code>epsilon</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Small value for stability. Defaults to 1e-7.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><span class="xref">T</span></dt>
    <dd><p>log(clamp(probability, epsilon, 1-epsilon))</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_SafeLog_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.SafeLog*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_SafeLog__1___0_System_Double_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.SafeLog``1(``0,System.Double)">
  SafeLog&lt;T&gt;(T, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L60"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Computes the natural logarithm safely, avoiding log(0) and log(negative).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static T SafeLog&lt;T&gt;(T value, double epsilon = 1E-07)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>value</code> <span class="xref">T</span></dt>
    <dd><p>The value to compute log of.</p>
</dd>
    <dt><code>epsilon</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Small value to add for numerical stability. Defaults to 1e-7.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><span class="xref">T</span></dt>
    <dd><p>log(max(value, epsilon))</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>






  <h4 class="section" id="AiDotNet_Helpers_NumericalStabilityHelper_SafeLog__1___0_System_Double__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> The logarithm of zero is negative infinity, and log of negative
numbers is undefined. This method ensures we always compute log of a small positive number
at minimum, preventing NaN or -Infinity in your calculations.
</p>
</div>




  <a id="AiDotNet_Helpers_NumericalStabilityHelper_SafeSqrt_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.SafeSqrt*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_SafeSqrt__1___0_System_Double_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.SafeSqrt``1(``0,System.Double)">
  SafeSqrt&lt;T&gt;(T, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L104"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Computes square root safely, ensuring non-negative input.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static T SafeSqrt&lt;T&gt;(T value, double epsilon = 1E-07)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>value</code> <span class="xref">T</span></dt>
    <dd><p>The value to compute square root of.</p>
</dd>
    <dt><code>epsilon</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Small value to ensure positive input. Defaults to 1e-7.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><span class="xref">T</span></dt>
    <dd><p>sqrt(max(value, epsilon))</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_NumericalStabilityHelper_StableLogSoftmax_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.StableLogSoftmax*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_StableLogSoftmax__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.StableLogSoftmax``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0})">
  StableLogSoftmax&lt;T&gt;(Vector&lt;T&gt;?)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L400"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Computes log-softmax with numerical stability.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static Vector&lt;T&gt;? StableLogSoftmax&lt;T&gt;(Vector&lt;T&gt;? logits)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>logits</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The input logits.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>Log-softmax values.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>






  <h4 class="section" id="AiDotNet_Helpers_NumericalStabilityHelper_StableLogSoftmax__1_AiDotNet_Tensors_LinearAlgebra_Vector___0___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> Log-softmax is log(softmax(x)), which is more numerically
stable than computing softmax first and then taking the log. It's commonly used
in cross-entropy loss calculations.
</p>
</div>




  <a id="AiDotNet_Helpers_NumericalStabilityHelper_StableSoftmax_" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.StableSoftmax*"></a>

  <h3 id="AiDotNet_Helpers_NumericalStabilityHelper_StableSoftmax__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__" data-uid="AiDotNet.Helpers.NumericalStabilityHelper.StableSoftmax``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0})">
  StableSoftmax&lt;T&gt;(Vector&lt;T&gt;?)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L350"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Computes softmax with numerical stability using the log-sum-exp trick.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static Vector&lt;T&gt;? StableSoftmax&lt;T&gt;(Vector&lt;T&gt;? logits)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>logits</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The input logits.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>Softmax probabilities.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>






  <h4 class="section" id="AiDotNet_Helpers_NumericalStabilityHelper_StableSoftmax__1_AiDotNet_Tensors_LinearAlgebra_Vector___0___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> Softmax converts a vector of numbers into probabilities.
The standard formula exp(x_i) / sum(exp(x_j)) can overflow for large values.
This implementation subtracts the maximum value first to prevent overflow.
</p>
</div>





</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/NumericalStabilityHelper.cs/#L17" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          AiDotNet - Enterprise AI/ML Library for .NET
        </div>
      </div>
    </footer>
  </body>
</html>
