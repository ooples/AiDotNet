<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class ContextWindowManager | AiDotNet Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class ContextWindowManager | AiDotNet Documentation ">
      
      <meta name="description" content="Manages context window limits for LLM prompts, providing token estimation and text truncation utilities.">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ooples/AiDotNet/new/master/apiSpec/new?filename=AiDotNet_PromptEngineering_ContextWindowManager.md&amp;value=---%0Auid%3A%20AiDotNet.PromptEngineering.ContextWindowManager%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="AiDotNet">
            AiDotNet
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="AiDotNet.PromptEngineering.ContextWindowManager">



  <h1 id="AiDotNet_PromptEngineering_ContextWindowManager" data-uid="AiDotNet.PromptEngineering.ContextWindowManager" class="text-break">
Class ContextWindowManager  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/PromptEngineering/ContextWindowManager.cs/#L35"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="AiDotNet.html">AiDotNet</a>.<a class="xref" href="AiDotNet.PromptEngineering.html">PromptEngineering</a></dd></dl>
  <dl><dt>Assembly</dt><dd>AiDotNet.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Manages context window limits for LLM prompts, providing token estimation and text truncation utilities.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class ContextWindowManager</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">ContextWindowManager</span></div>
    </dd>
  </dl>



  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>




  <h2 id="AiDotNet_PromptEngineering_ContextWindowManager_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p>
This class helps manage the token limits of large language models by providing utilities
to estimate token counts, check if text fits within the context window, and truncate
or split text that exceeds the limit.
</p>
<p><b>For Beginners:</b> Large Language Models have a maximum number of tokens they can process
at once (the "context window"). This class helps you:
<p>Example:</p>
<pre><code class="lang-csharp">// Create a manager with 4096 token limit
var manager = new ContextWindowManager(4096);

// Check if your prompt fits
var prompt = &quot;Your long prompt here...&quot;;
if (!manager.FitsInWindow(prompt))
{
    // Truncate to fit
    prompt = manager.TruncateToFit(prompt);
}

// Or split long text into chunks
var chunks = manager.SplitIntoChunks(longDocument);
</code></pre>
<p>A token is roughly 4 characters or 0.75 words in English, but varies by language and model.</p>

</div>


  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="AiDotNet_PromptEngineering_ContextWindowManager__ctor_" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.#ctor*"></a>

  <h3 id="AiDotNet_PromptEngineering_ContextWindowManager__ctor_System_Int32_" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.#ctor(System.Int32)">
  ContextWindowManager(int)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/PromptEngineering/ContextWindowManager.cs/#L69"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Initializes a new instance of the ContextWindowManager with the specified maximum tokens.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public ContextWindowManager(int maxTokens)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>maxTokens</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The maximum number of tokens allowed in the context window.</p>
</dd>
  </dl>








  <h4 class="section" id="AiDotNet_PromptEngineering_ContextWindowManager__ctor_System_Int32__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
Uses a default token estimator that approximates tokens as text.Length / 4,
which is a reasonable approximation for English text.
</p>
<p><b>For Beginners:</b> Just specify the token limit for your model:
<pre><code class="lang-csharp">// For GPT-4 with 8K context
var manager = new ContextWindowManager(8192);

// For Claude with 100K context
var manager = new ContextWindowManager(100000);
</code></pre>

</div>




  <a id="AiDotNet_PromptEngineering_ContextWindowManager__ctor_" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.#ctor*"></a>

  <h3 id="AiDotNet_PromptEngineering_ContextWindowManager__ctor_System_Int32_System_Func_System_String_System_Int32__" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.#ctor(System.Int32,System.Func{System.String,System.Int32})">
  ContextWindowManager(int, Func&lt;string, int&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/PromptEngineering/ContextWindowManager.cs/#L96"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Initializes a new instance of the ContextWindowManager with a custom token estimator.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public ContextWindowManager(int maxTokens, Func&lt;string, int&gt; tokenEstimator)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>maxTokens</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The maximum number of tokens allowed in the context window.</p>
</dd>
    <dt><code>tokenEstimator</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.func-2">Func</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a>&gt;</dt>
    <dd><p>A function that estimates the number of tokens in a given text.</p>
</dd>
  </dl>








  <h4 class="section" id="AiDotNet_PromptEngineering_ContextWindowManager__ctor_System_Int32_System_Func_System_String_System_Int32___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
Use this constructor when you need precise token counting, such as when using
a specific tokenizer like tiktoken for OpenAI models.
</p>
<p><b>For Beginners:</b> Use a custom estimator for more accurate counting:
<pre><code class="lang-csharp">// Simple character-based estimator
var manager = new ContextWindowManager(4096, text =&gt; text.Length / 4);

// Word-based estimator
var manager = new ContextWindowManager(4096, text =&gt;
    text.Split(' ', StringSplitOptions.RemoveEmptyEntries).Length * 4 / 3);
</code></pre>

</div>




  <h2 class="section" id="properties">Properties
</h2>


  <a id="AiDotNet_PromptEngineering_ContextWindowManager_MaxTokens_" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.MaxTokens*"></a>

  <h3 id="AiDotNet_PromptEngineering_ContextWindowManager_MaxTokens" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.MaxTokens">
  MaxTokens
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/PromptEngineering/ContextWindowManager.cs/#L47"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets the maximum number of tokens allowed in the context window.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public int MaxTokens { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd></dd>
  </dl>




  <h4 class="section" id="AiDotNet_PromptEngineering_ContextWindowManager_MaxTokens_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This is the total capacity of the model's context window.
Common values are 4096, 8192, 16384, 32768, or 128000 depending on the model.
</p>
</div>




  <h2 class="section" id="methods">Methods
</h2>


  <a id="AiDotNet_PromptEngineering_ContextWindowManager_EstimateTokens_" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.EstimateTokens*"></a>

  <h3 id="AiDotNet_PromptEngineering_ContextWindowManager_EstimateTokens_System_String_" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.EstimateTokens(System.String)">
  EstimateTokens(string)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/PromptEngineering/ContextWindowManager.cs/#L120"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Estimates the number of tokens in the given text.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public int EstimateTokens(string text)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>text</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The text to estimate tokens for.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The estimated number of tokens.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_PromptEngineering_ContextWindowManager_EstimateTokens_System_String__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
The accuracy depends on the token estimator provided. The default estimator
uses a simple character-based approximation.
</p>
<p><b>For Beginners:</b> Use this to check how many tokens your text uses:
<pre><code class="lang-csharp">var tokens = manager.EstimateTokens(&quot;Hello, world!&quot;);
Console.WriteLine($&quot;This text uses approximately {tokens} tokens&quot;);
</code></pre>

</div>




  <a id="AiDotNet_PromptEngineering_ContextWindowManager_FitsInWindow_" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.FitsInWindow*"></a>

  <h3 id="AiDotNet_PromptEngineering_ContextWindowManager_FitsInWindow_System_String_System_Int32_" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.FitsInWindow(System.String,System.Int32)">
  FitsInWindow(string, int)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/PromptEngineering/ContextWindowManager.cs/#L156"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Checks if the given text fits within the context window.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool FitsInWindow(string text, int reservedTokens = 0)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>text</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The text to check.</p>
</dd>
    <dt><code>reservedTokens</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>Number of tokens to reserve for other content (e.g., system prompt, response).</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if the text fits within the available window space; otherwise, false.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_PromptEngineering_ContextWindowManager_FitsInWindow_System_String_System_Int32__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
The reserved tokens parameter allows you to account for tokens that will be used
by system prompts, few-shot examples, or expected response length.
</p>
<p><b>For Beginners:</b> Check if your prompt will fit:
<pre><code class="lang-csharp">// Basic check
if (manager.FitsInWindow(myPrompt))
{
    // Safe to send to the model
}

// Reserve space for the response
if (manager.FitsInWindow(myPrompt, reservedTokens: 500))
{
    // Prompt fits with 500 tokens reserved for response
}
</code></pre>

</div>




  <a id="AiDotNet_PromptEngineering_ContextWindowManager_RemainingTokens_" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.RemainingTokens*"></a>

  <h3 id="AiDotNet_PromptEngineering_ContextWindowManager_RemainingTokens_System_String_System_Int32_" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.RemainingTokens(System.String,System.Int32)">
  RemainingTokens(string, int)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/PromptEngineering/ContextWindowManager.cs/#L180"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Calculates the remaining tokens available after accounting for the given text.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public int RemainingTokens(string text, int reservedTokens = 0)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>text</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The text currently using the window.</p>
</dd>
    <dt><code>reservedTokens</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>Number of tokens to reserve for other content.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The number of remaining tokens available, or 0 if exceeded.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_PromptEngineering_ContextWindowManager_RemainingTokens_System_String_System_Int32__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
This is useful for determining how much additional content can be added to a prompt.
</p>
<p><b>For Beginners:</b> Find out how much space is left:
<pre><code class="lang-csharp">var remaining = manager.RemainingTokens(currentPrompt);
Console.WriteLine($&quot;You can add approximately {remaining} more tokens&quot;);
</code></pre>

</div>




  <a id="AiDotNet_PromptEngineering_ContextWindowManager_SplitIntoChunks_" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.SplitIntoChunks*"></a>

  <h3 id="AiDotNet_PromptEngineering_ContextWindowManager_SplitIntoChunks_System_String_System_Int32_" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.SplitIntoChunks(System.String,System.Int32)">
  SplitIntoChunks(string, int)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/PromptEngineering/ContextWindowManager.cs/#L270"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Splits the text into chunks that each fit within the context window.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public List&lt;string&gt; SplitIntoChunks(string text, int overlapTokens = 0)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>text</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The text to split.</p>
</dd>
    <dt><code>overlapTokens</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>Number of tokens to overlap between chunks for context continuity.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.list-1">List</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>&gt;</dt>
    <dd><p>A list of text chunks that each fit within the window.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_PromptEngineering_ContextWindowManager_SplitIntoChunks_System_String_System_Int32__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
This is useful for processing long documents that exceed the context window.
The overlap parameter allows maintaining context between chunks.
</p>
<p><b>For Beginners:</b> Process long documents in pieces:
<pre><code class="lang-csharp">var document = LoadLongDocument();
var chunks = manager.SplitIntoChunks(document);

foreach (var chunk in chunks)
{
    var response = await model.ProcessAsync(chunk);
    // Handle each chunk's response
}

// With overlap for better context continuity
var overlappingChunks = manager.SplitIntoChunks(document, overlapTokens: 100);
</code></pre>

</div>




  <a id="AiDotNet_PromptEngineering_ContextWindowManager_TruncateToFit_" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.TruncateToFit*"></a>

  <h3 id="AiDotNet_PromptEngineering_ContextWindowManager_TruncateToFit_System_String_System_Int32_" data-uid="AiDotNet.PromptEngineering.ContextWindowManager.TruncateToFit(System.String,System.Int32)">
  TruncateToFit(string, int)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/PromptEngineering/ContextWindowManager.cs/#L206"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Truncates the text to fit within the context window.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public string TruncateToFit(string text, int reservedTokens = 0)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>text</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The text to truncate.</p>
</dd>
    <dt><code>reservedTokens</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>Number of tokens to reserve for other content.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The truncated text that fits within the window, or the original if it already fits.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_PromptEngineering_ContextWindowManager_TruncateToFit_System_String_System_Int32__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
Uses binary search to find the optimal truncation point, ensuring the result
fits within the available token budget.
</p>
<p><b>For Beginners:</b> Automatically shorten text to fit:
<pre><code class="lang-csharp">var longDocument = LoadDocument(); // Very long text
var fittingText = manager.TruncateToFit(longDocument);
// fittingText is guaranteed to fit in the context window
</code></pre>

</div>





</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ooples/AiDotNet/blob/master/src/PromptEngineering/ContextWindowManager.cs/#L35" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          AiDotNet - Enterprise AI/ML Library for .NET
        </div>
      </div>
    </footer>
  </body>
</html>
