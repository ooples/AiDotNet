<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class LearnedSparseEncoderExpansion | AiDotNet Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class LearnedSparseEncoderExpansion | AiDotNet Documentation ">
      
      <meta name="description" content="Expands queries using learned sparse representations (SPLADE-like) with term importance weighting for hybrid retrieval.">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ooples/AiDotNet/new/master/apiSpec/new?filename=AiDotNet_RetrievalAugmentedGeneration_QueryExpansion_LearnedSparseEncoderExpansion.md&amp;value=---%0Auid%3A%20AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.LearnedSparseEncoderExpansion%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="AiDotNet">
            AiDotNet
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.LearnedSparseEncoderExpansion">



  <h1 id="AiDotNet_RetrievalAugmentedGeneration_QueryExpansion_LearnedSparseEncoderExpansion" data-uid="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.LearnedSparseEncoderExpansion" class="text-break">
Class LearnedSparseEncoderExpansion  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/RetrievalAugmentedGeneration/QueryExpansion/LearnedSparseEncoderExpansion.cs/#L61"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="AiDotNet.html">AiDotNet</a>.<a class="xref" href="AiDotNet.RetrievalAugmentedGeneration.html">RetrievalAugmentedGeneration</a>.<a class="xref" href="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.html">QueryExpansion</a></dd></dl>
  <dl><dt>Assembly</dt><dd>AiDotNet.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Expands queries using learned sparse representations (SPLADE-like) with term importance weighting for hybrid retrieval.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class LearnedSparseEncoderExpansion : QueryExpansionBase</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><a class="xref" href="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.QueryExpansionBase.html">QueryExpansionBase</a></div>
      <div><span class="xref">LearnedSparseEncoderExpansion</span></div>
    </dd>
  </dl>



  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>




  <h2 id="AiDotNet_RetrievalAugmentedGeneration_QueryExpansion_LearnedSparseEncoderExpansion_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p>
LearnedSparseEncoderExpansion combines the benefits of sparse (keyword-based) and dense (semantic) retrieval by
using a learned model to expand queries with semantically related terms weighted by importance. Unlike traditional
query expansion that adds synonyms uniformly, this approach uses neural networks (e.g., SPLADE) to predict term
relevance scores, generating sparse representations where only important expansion terms are included. The model
learns which terms to add and their weights through training on retrieval tasks. This implementation provides a
heuristic-based fallback using term statistics (length, capitalization, occurrence patterns) and morphological
variations, but is designed to load actual SPLADE or similar models for production use. The weighted expansion
improves both recall (finds related documents) and precision (weights focus on relevant terms).
</p>
<p><b>For Beginners:</b> Think of this like a smart thesaurus that knows which related words actually matter:
<p>Regular thesaurus expansion: &quot;fast&quot; → &quot;quick rapid speedy swift hasty&quot; (all equally)</p>
<p>Learned sparse expansion: &quot;fast&quot; → &quot;quick(0.8) rapid(0.7) speed(0.6)&quot; (weighted by importance)</p>
<p>The weights tell the search how much each term matters!</p>
<p>Example query: &quot;neural network training&quot;</p>
<p>Expansion with weights:</p>
<ul>
<li>Original: neural(1.0) network(1.0) training(1.0)</li>
<li>Expanded: neural(1.0) network(1.0) training(1.0) + networks(0.7) train(0.6) learning(0.8) optimization(0.7)</li>
</ul>
<pre><code class="lang-csharp">var expander = new LearnedSparseEncoderExpansion(
    modelPath: &quot;models/splade.onnx&quot;,
    maxExpansionTerms: 10,
    minTermWeight: 0.5              // Only include terms weighted &gt;= 0.5
);

var queries = expander.ExpandQuery(&quot;climate change mitigation&quot;);
// Returns: [&quot;climate change mitigation&quot;, 
//           &quot;climate climate change change mitigation global warming reduction carbon&quot;] 
// (term repetition encodes weights)
</code></pre>
<p>Why use LearnedSparseEncoderExpansion:</p>
<ul>
<li>Best of both worlds: keyword precision + semantic expansion</li>
<li>Learned weights focus on truly relevant terms (not all synonyms)</li>
<li>Handles domain-specific terminology better than generic expansion</li>
<li>Effective for technical and scientific queries</li>
</ul>
<p>When NOT to use it:</p>
<ul>
<li>Model not available (requires trained SPLADE/similar model)</li>
<li>Simple keyword matching is sufficient</li>
<li>Storage-constrained systems (expanded representations use more space)</li>
<li>When pure semantic search works well enough (dense retrieval)</li>
</ul>

</div>


  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="AiDotNet_RetrievalAugmentedGeneration_QueryExpansion_LearnedSparseEncoderExpansion__ctor_" data-uid="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.LearnedSparseEncoderExpansion.#ctor*"></a>

  <h3 id="AiDotNet_RetrievalAugmentedGeneration_QueryExpansion_LearnedSparseEncoderExpansion__ctor_System_String_System_Int32_System_Double_" data-uid="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.LearnedSparseEncoderExpansion.#ctor(System.String,System.Int32,System.Double)">
  LearnedSparseEncoderExpansion(string, int, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/RetrievalAugmentedGeneration/QueryExpansion/LearnedSparseEncoderExpansion.cs/#L73"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Initializes a new instance of the <a class="xref" href="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.LearnedSparseEncoderExpansion.html">LearnedSparseEncoderExpansion</a> class.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public LearnedSparseEncoderExpansion(string modelPath, int maxExpansionTerms, double minTermWeight)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>modelPath</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>Path to the SPLADE or similar model.</p>
</dd>
    <dt><code>maxExpansionTerms</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>Maximum number of expansion terms to add.</p>
</dd>
    <dt><code>minTermWeight</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Minimum weight threshold for including a term.</p>
</dd>
  </dl>












  <h2 class="section" id="methods">Methods
</h2>


  <a id="AiDotNet_RetrievalAugmentedGeneration_QueryExpansion_LearnedSparseEncoderExpansion_ExpandQuery_" data-uid="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.LearnedSparseEncoderExpansion.ExpandQuery*"></a>

  <h3 id="AiDotNet_RetrievalAugmentedGeneration_QueryExpansion_LearnedSparseEncoderExpansion_ExpandQuery_System_String_" data-uid="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.LearnedSparseEncoderExpansion.ExpandQuery(System.String)">
  ExpandQuery(string)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/RetrievalAugmentedGeneration/QueryExpansion/LearnedSparseEncoderExpansion.cs/#L88"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Expands a query into multiple variations.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public override List&lt;string&gt; ExpandQuery(string query)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>query</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The original query.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.list-1">List</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>&gt;</dt>
    <dd><p>A list of expanded queries.</p>
</dd>
  </dl>












</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ooples/AiDotNet/blob/master/src/RetrievalAugmentedGeneration/QueryExpansion/LearnedSparseEncoderExpansion.cs/#L61" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          AiDotNet - Enterprise AI/ML Library for .NET
        </div>
      </div>
    </footer>
  </body>
</html>
