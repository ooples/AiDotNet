<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class NBEATSBlock&lt;T&gt; | AiDotNet Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class NBEATSBlock&lt;T&gt; | AiDotNet Documentation ">
      
      <meta name="description" content="Represents a single block in the N-BEATS architecture.">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ooples/AiDotNet/new/master/apiSpec/new?filename=AiDotNet_TimeSeries_NBEATSBlock_1.md&amp;value=---%0Auid%3A%20AiDotNet.TimeSeries.NBEATSBlock%601%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="AiDotNet">
            AiDotNet
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="AiDotNet.TimeSeries.NBEATSBlock`1">



  <h1 id="AiDotNet_TimeSeries_NBEATSBlock_1" data-uid="AiDotNet.TimeSeries.NBEATSBlock`1" class="text-break">
Class NBEATSBlock&lt;T&gt;  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/TimeSeries/NBEATSBlock.cs/#L31"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="AiDotNet.html">AiDotNet</a>.<a class="xref" href="AiDotNet.TimeSeries.html">TimeSeries</a></dd></dl>
  <dl><dt>Assembly</dt><dd>AiDotNet.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Represents a single block in the N-BEATS architecture.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class NBEATSBlock&lt;T&gt;</code></pre>
  </div>



  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type used for calculations (e.g., float, double).</p>
</dd>
  </dl>

  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">NBEATSBlock&lt;T&gt;</span></div>
    </dd>
  </dl>



  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>




  <h2 id="AiDotNet_TimeSeries_NBEATSBlock_1_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p>
Each N-BEATS block consists of:
1. A stack of fully connected layers (the "theta" network)
2. A basis expansion layer for generating backcast (reconstruction of input)
3. A basis expansion layer for generating forecast (prediction of future)
</p>
<p>
The block architecture implements a doubly residual stacking principle:
- Backcast residual: Input minus backcast is passed to the next block
- Forecast addition: Forecasts from all blocks are summed for the final prediction
</p>
<p><b>For Beginners:</b> A block is the basic building unit of N-BEATS. Think of it like
a specialized predictor that:
1. Looks at the input time series
2. Tries to reconstruct what it saw (backcast)
3. Predicts the future (forecast)
4. Passes the "leftover" patterns it couldn't explain to the next block
<p>Multiple blocks work together, with each one focusing on different aspects of the data.</p>

</div>


  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="AiDotNet_TimeSeries_NBEATSBlock_1__ctor_" data-uid="AiDotNet.TimeSeries.NBEATSBlock`1.#ctor*"></a>

  <h3 id="AiDotNet_TimeSeries_NBEATSBlock_1__ctor_System_Int32_System_Int32_System_Int32_System_Int32_System_Int32_System_Int32_System_Boolean_System_Int32_" data-uid="AiDotNet.TimeSeries.NBEATSBlock`1.#ctor(System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Boolean,System.Int32)">
  NBEATSBlock(int, int, int, int, int, int, bool, int)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/TimeSeries/NBEATSBlock.cs/#L93"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Initializes a new instance of the NBEATSBlock class.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public NBEATSBlock(int lookbackWindow, int forecastHorizon, int hiddenLayerSize, int numHiddenLayers, int thetaSizeBackcast, int thetaSizeForecast, bool useInterpretableBasis, int polynomialDegree = 3)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>lookbackWindow</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The number of historical time steps used as input.</p>
</dd>
    <dt><code>forecastHorizon</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The number of future time steps to predict.</p>
</dd>
    <dt><code>hiddenLayerSize</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The size of hidden layers in the fully connected network.</p>
</dd>
    <dt><code>numHiddenLayers</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The number of hidden layers.</p>
</dd>
    <dt><code>thetaSizeBackcast</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The size of the theta vector for backcast basis expansion.</p>
</dd>
    <dt><code>thetaSizeForecast</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The size of the theta vector for forecast basis expansion.</p>
</dd>
    <dt><code>useInterpretableBasis</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>Whether to use interpretable basis functions.</p>
</dd>
    <dt><code>polynomialDegree</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The polynomial degree for trend basis (if interpretable).</p>
</dd>
  </dl>








  <h4 class="section" id="AiDotNet_TimeSeries_NBEATSBlock_1__ctor_System_Int32_System_Int32_System_Int32_System_Int32_System_Int32_System_Int32_System_Boolean_System_Int32__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This creates a new block with specific parameters:
- lookbackWindow: How far back in time the block looks
- forecastHorizon: How far forward in time the block predicts
- hiddenLayerSize: How many neurons in each hidden layer (bigger = more capacity)
- numHiddenLayers: How many hidden layers (deeper = more complex patterns)
- useInterpretableBasis: Whether to use human-understandable basis functions
</p>
</div>




  <h2 class="section" id="properties">Properties
</h2>


  <a id="AiDotNet_TimeSeries_NBEATSBlock_1_ParameterCount_" data-uid="AiDotNet.TimeSeries.NBEATSBlock`1.ParameterCount*"></a>

  <h3 id="AiDotNet_TimeSeries_NBEATSBlock_1_ParameterCount" data-uid="AiDotNet.TimeSeries.NBEATSBlock`1.ParameterCount">
  ParameterCount
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/TimeSeries/NBEATSBlock.cs/#L56"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets the total number of trainable parameters in the block.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public int ParameterCount { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd></dd>
  </dl>








  <h2 class="section" id="methods">Methods
</h2>


  <a id="AiDotNet_TimeSeries_NBEATSBlock_1_ExportComputationGraph_" data-uid="AiDotNet.TimeSeries.NBEATSBlock`1.ExportComputationGraph*"></a>

  <h3 id="AiDotNet_TimeSeries_NBEATSBlock_1_ExportComputationGraph_AiDotNet_Autodiff_ComputationNode__0__" data-uid="AiDotNet.TimeSeries.NBEATSBlock`1.ExportComputationGraph(AiDotNet.Autodiff.ComputationNode{`0})">
  ExportComputationGraph(ComputationNode&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/TimeSeries/NBEATSBlock.cs/#L452"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Exports the block as computation graph nodes for JIT compilation.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public (ComputationNode&lt;T&gt; backcast, ComputationNode&lt;T&gt; forecast) ExportComputationGraph(ComputationNode&lt;T&gt; inputNode)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>inputNode</code> <a class="xref" href="AiDotNet.Autodiff.ComputationNode-1.html">ComputationNode</a>&lt;T&gt;</dt>
    <dd><p>The input computation node (residual from previous block).</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt>(<a class="xref" href="AiDotNet.Autodiff.ComputationNode-1.html">ComputationNode</a>&lt;T&gt;, <a class="xref" href="AiDotNet.Autodiff.ComputationNode-1.html">ComputationNode</a>&lt;T&gt;)</dt>
    <dd><p>A tuple containing (backcast, forecast) computation nodes.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_TimeSeries_NBEATSBlock_1_ExportComputationGraph_AiDotNet_Autodiff_ComputationNode__0___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
This method creates a computation graph that represents the forward pass through
the N-BEATS block, enabling JIT compilation for optimized inference.
</p>
<p><b>For Beginners:</b> This converts the block's calculations into a format
that can be optimized by the JIT compiler. The resulting computation graph
represents:
1. Passing input through fully connected layers with ReLU activation
2. Computing theta parameters for backcast and forecast
3. Applying basis expansion to generate backcast and forecast
</p>
</div>




  <a id="AiDotNet_TimeSeries_NBEATSBlock_1_Forward_" data-uid="AiDotNet.TimeSeries.NBEATSBlock`1.Forward*"></a>

  <h3 id="AiDotNet_TimeSeries_NBEATSBlock_1_Forward_AiDotNet_Tensors_LinearAlgebra_Vector__0__" data-uid="AiDotNet.TimeSeries.NBEATSBlock`1.Forward(AiDotNet.Tensors.LinearAlgebra.Vector{`0})">
  Forward(Vector&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/TimeSeries/NBEATSBlock.cs/#L230"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Performs the forward pass through the block.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public (Vector&lt;T&gt; backcast, Vector&lt;T&gt; forecast) Forward(Vector&lt;T&gt; input)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>input</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The input time series vector of length lookbackWindow.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt>(<a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt; <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-aidotnet.tensors.linearalgebra.vector--0-,aidotnet.tensors.linearalgebra.vector--0--.mean">mean</a>, <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt; <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-aidotnet.tensors.linearalgebra.vector--0-,aidotnet.tensors.linearalgebra.vector--0--.logvar">logVar</a>)</dt>
    <dd><p>A tuple containing (backcast, forecast) vectors.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_TimeSeries_NBEATSBlock_1_Forward_AiDotNet_Tensors_LinearAlgebra_Vector__0___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
The forward pass:
1. Passes input through fully connected layers with ReLU activation
2. Computes theta parameters for backcast and forecast
3. Applies basis expansion to generate backcast and forecast
</p>
<p><b>For Beginners:</b> This is where the block actually processes the input data.
It takes the historical time series, runs it through the neural network layers,
and produces two outputs:
- Backcast: The block's attempt to reconstruct the input (what it understood)
- Forecast: The block's prediction of future values
</p>
</div>




  <a id="AiDotNet_TimeSeries_NBEATSBlock_1_GetParameters_" data-uid="AiDotNet.TimeSeries.NBEATSBlock`1.GetParameters*"></a>

  <h3 id="AiDotNet_TimeSeries_NBEATSBlock_1_GetParameters" data-uid="AiDotNet.TimeSeries.NBEATSBlock`1.GetParameters">
  GetParameters()
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/TimeSeries/NBEATSBlock.cs/#L364"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets all parameters (weights and biases) as a single vector.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public Vector&lt;T&gt; GetParameters()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>A vector containing all trainable parameters.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_TimeSeries_NBEATSBlock_1_GetParameters_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This method collects all the weights and biases from
all layers into one long vector. This is useful for saving the model or for
certain optimization algorithms.
</p>
</div>




  <a id="AiDotNet_TimeSeries_NBEATSBlock_1_SetParameters_" data-uid="AiDotNet.TimeSeries.NBEATSBlock`1.SetParameters*"></a>

  <h3 id="AiDotNet_TimeSeries_NBEATSBlock_1_SetParameters_AiDotNet_Tensors_LinearAlgebra_Vector__0__" data-uid="AiDotNet.TimeSeries.NBEATSBlock`1.SetParameters(AiDotNet.Tensors.LinearAlgebra.Vector{`0})">
  SetParameters(Vector&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/TimeSeries/NBEATSBlock.cs/#L397"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Sets all parameters (weights and biases) from a single vector.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void SetParameters(Vector&lt;T&gt; parameters)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>parameters</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>A vector containing all trainable parameters.</p>
</dd>
  </dl>








  <h4 class="section" id="AiDotNet_TimeSeries_NBEATSBlock_1_SetParameters_AiDotNet_Tensors_LinearAlgebra_Vector__0___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This is the opposite of GetParameters - it takes
a long vector of numbers and distributes them back to all the weights and biases
in the block. This is useful for loading a saved model.
</p>
</div>





</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ooples/AiDotNet/blob/master/src/TimeSeries/NBEATSBlock.cs/#L31" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          AiDotNet - Enterprise AI/ML Library for .NET
        </div>
      </div>
    </footer>
  </body>
</html>
