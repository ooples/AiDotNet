<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class MetaSGDAlgorithm&lt;T, TInput, TOutput&gt; | AiDotNet Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class MetaSGDAlgorithm&lt;T, TInput, TOutput&gt; | AiDotNet Documentation ">
      
      <meta name="description" content="Implementation of Meta-SGD (Meta Stochastic Gradient Descent) algorithm.">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ooples/AiDotNet/new/master/apiSpec/new?filename=AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3.md&amp;value=---%0Auid%3A%20AiDotNet.MetaLearning.Algorithms.MetaSGDAlgorithm%603%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="AiDotNet">
            AiDotNet
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="AiDotNet.MetaLearning.Algorithms.MetaSGDAlgorithm`3">



  <h1 id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3" data-uid="AiDotNet.MetaLearning.Algorithms.MetaSGDAlgorithm`3" class="text-break">
Class MetaSGDAlgorithm&lt;T, TInput, TOutput&gt;  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/MetaLearning/Algorithms/MetaSGDAlgorithm.cs/#L83"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="AiDotNet.html">AiDotNet</a>.<a class="xref" href="AiDotNet.MetaLearning.html">MetaLearning</a>.<a class="xref" href="AiDotNet.MetaLearning.Algorithms.html">Algorithms</a></dd></dl>
  <dl><dt>Assembly</dt><dd>AiDotNet.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Implementation of Meta-SGD (Meta Stochastic Gradient Descent) algorithm.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class MetaSGDAlgorithm&lt;T, TInput, TOutput&gt; : MetaLearnerBase&lt;T, TInput, TOutput&gt;, IMetaLearner&lt;T, TInput, TOutput&gt;</code></pre>
  </div>



  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type used for calculations (e.g., float, double).</p>
</dd>
    <dt><code>TInput</code></dt>
    <dd><p>The input data type (e.g., Matrix&lt;T&gt;, Tensor&lt;T&gt;).</p>
</dd>
    <dt><code>TOutput</code></dt>
    <dd><p>The output data type (e.g., Vector&lt;T&gt;, Tensor&lt;T&gt;).</p>
</dd>
  </dl>

  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html">MetaLearnerBase</a>&lt;T, TInput, TOutput&gt;</div>
      <div><span class="xref">MetaSGDAlgorithm&lt;T, TInput, TOutput&gt;</span></div>
    </dd>
  </dl>

  <dl class="typelist implements">
    <dt>Implements</dt>
    <dd>
      <div><a class="xref" href="AiDotNet.Interfaces.IMetaLearner-3.html">IMetaLearner</a>&lt;T, TInput, TOutput&gt;</div>
    </dd>
  </dl>


  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_MetaModel">MetaLearnerBase&lt;T, TInput, TOutput&gt;.MetaModel</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_LossFunction">MetaLearnerBase&lt;T, TInput, TOutput&gt;.LossFunction</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3__options">MetaLearnerBase&lt;T, TInput, TOutput&gt;._options</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_DataLoader">MetaLearnerBase&lt;T, TInput, TOutput&gt;.DataLoader</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_NumOps">MetaLearnerBase&lt;T, TInput, TOutput&gt;.NumOps</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_RandomGenerator">MetaLearnerBase&lt;T, TInput, TOutput&gt;.RandomGenerator</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_MetaOptimizer">MetaLearnerBase&lt;T, TInput, TOutput&gt;.MetaOptimizer</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_InnerOptimizer">MetaLearnerBase&lt;T, TInput, TOutput&gt;.InnerOptimizer</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3__currentIteration">MetaLearnerBase&lt;T, TInput, TOutput&gt;._currentIteration</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Engine">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Engine</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_BaseModel">MetaLearnerBase&lt;T, TInput, TOutput&gt;.BaseModel</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Options">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Options</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_CurrentIteration">MetaLearnerBase&lt;T, TInput, TOutput&gt;.CurrentIteration</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_AlgorithmType">MetaLearnerBase&lt;T, TInput, TOutput&gt;.AlgorithmType</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_AdaptationSteps">MetaLearnerBase&lt;T, TInput, TOutput&gt;.AdaptationSteps</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_InnerLearningRate">MetaLearnerBase&lt;T, TInput, TOutput&gt;.InnerLearningRate</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_OuterLearningRate">MetaLearnerBase&lt;T, TInput, TOutput&gt;.OuterLearningRate</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_MetaTrain_AiDotNet_MetaLearning_Data_TaskBatch__0__1__2__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.MetaTrain(TaskBatch&lt;T, TInput, TOutput&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Adapt_AiDotNet_Interfaces_IMetaLearningTask__0__1__2__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Adapt(IMetaLearningTask&lt;T, TInput, TOutput&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Evaluate_AiDotNet_MetaLearning_Data_TaskBatch__0__1__2__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Evaluate(TaskBatch&lt;T, TInput, TOutput&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_MetaTrainStep_System_Int32_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.MetaTrainStep(int)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Train">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Train()</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Evaluate_System_Int32_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Evaluate(int)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_AdaptAndEvaluate_AiDotNet_Data_Structures_MetaLearningTask__0__1__2__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.AdaptAndEvaluate(MetaLearningTask&lt;T, TInput, TOutput&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_GetMetaModel">MetaLearnerBase&lt;T, TInput, TOutput&gt;.GetMetaModel()</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_SetMetaModel_AiDotNet_Interfaces_IFullModel__0__1__2__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.SetMetaModel(IFullModel&lt;T, TInput, TOutput&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Save_System_String_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Save(string)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Load_System_String_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Load(string)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Reset">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Reset()</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ComputeGradients_AiDotNet_Interfaces_IFullModel__0__1__2___1__2_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ComputeGradients(IFullModel&lt;T, TInput, TOutput&gt;, TInput, TOutput)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ComputeSecondOrderGradients_AiDotNet_Interfaces_IFullModel__0__1__2__System_Collections_Generic_List_System_ValueTuple__1__2____1__2__0_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ComputeSecondOrderGradients(IFullModel&lt;T, TInput, TOutput&gt;, List&lt;(TInput input, TOutput target)&gt;, TInput, TOutput, T)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ApplyGradients_AiDotNet_Tensors_LinearAlgebra_Vector__0__AiDotNet_Tensors_LinearAlgebra_Vector__0__System_Double_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ApplyGradients(Vector&lt;T&gt;, Vector&lt;T&gt;, double)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ClipGradients_AiDotNet_Tensors_LinearAlgebra_Vector__0__System_Nullable_System_Double__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ClipGradients(Vector&lt;T&gt;, double?)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_CreateTaskBatch_System_Collections_Generic_IReadOnlyList_AiDotNet_Data_Structures_MetaLearningTask__0__1__2___">MetaLearnerBase&lt;T, TInput, TOutput&gt;.CreateTaskBatch(IReadOnlyList&lt;MetaLearningTask&lt;T, TInput, TOutput&gt;&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ToMetaLearningTask_AiDotNet_Data_Structures_MetaLearningTask__0__1__2__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ToMetaLearningTask(MetaLearningTask&lt;T, TInput, TOutput&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ComputeAccuracy__2__2_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ComputeAccuracy(TOutput, TOutput)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ComputeLossFromOutput__2__2_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ComputeLossFromOutput(TOutput, TOutput)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ConvertToVector__2_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ConvertToVector(TOutput)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ComputeMean_System_Collections_Generic_List__0__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ComputeMean(List&lt;T&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_CloneModel">MetaLearnerBase&lt;T, TInput, TOutput&gt;.CloneModel()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>




  <h2 id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p>
Meta-SGD learns per-parameter learning rates for meta-learning. Instead of
learning just initialization parameters like MAML, it learns the learning
rate, momentum, and direction for each parameter individually, which can be
seen as learning a custom optimizer for each parameter.
</p>
<p>
<b>For Beginners:</b> Meta-SGD learns how to update each parameter individually:
</p>
<p>
In regular training, you use one learning rate for all weights. But different
parts of a neural network benefit from different learning rates. Meta-SGD
figures this out automatically by learning:
- <b>α_i:</b> The optimal learning rate for parameter i
- <b>β_i:</b> The optimal momentum for parameter i (optional)
- <b>d_i:</b> The optimal update direction/sign for parameter i (optional)
</p>
<p>
<b>Algorithm - Meta-SGD:</b>
<pre><code class="lang-csharp"># Learn per-parameter optimizers
for each parameter θ_i:
    learning_rate_i = learnable_parameter
    momentum_i = learnable_parameter (optional)
    direction_i = learnable_parameter (optional)

# Meta-training episode
for each task in task_batch:
    # Inner loop: adapt to task
    adapted_params = initial_params.copy()
    for step = 1 to K_inner:
        gradients = compute_gradients(adapted_params, support_set)
        for i in range(num_params):
            # Per-parameter update rule
            adapted_params[i] = update_rule_i(
                adapted_params[i],
                gradients[i],
                learning_rate_i,
                momentum_i,
                direction_i
            )

    # Evaluate on query set
    query_loss = evaluate(adapted_params, query_set)

    # Meta-update: optimize per-parameter coefficients
    meta_gradients = compute_meta_gradients(query_loss)
    update_per_parameter_optimizers(meta_gradients)</code></pre>

<p>
<b>Key Insights:</b>
1. <b>Per-Parameter Optimization:</b> Each parameter gets its own learned
   optimizer configuration, allowing heterogeneous learning rates across layers.
2. <b>First-Order Method:</b> No Hessian computation needed, much faster than
   second-order MAML while maintaining strong performance.
3. <b>Interpretable:</b> Learned per-parameter learning rates reveal which
   parameters are most important for quick adaptation.
4. <b>Flexible Update Rules:</b> Can combine with various base optimizers
   (SGD, Adam, RMSprop) for different adaptation characteristics.
</p>
<p>
<b>Reference:</b> Li, Z., Zhou, F., Chen, F., &amp; Li, H. (2017).
Meta-SGD: Learning to Learn Quickly for Few-Shot Learning.
</p>
</div>


  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3__ctor_" data-uid="AiDotNet.MetaLearning.Algorithms.MetaSGDAlgorithm`3.#ctor*"></a>

  <h3 id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3__ctor_AiDotNet_MetaLearning_Options_MetaSGDOptions__0__1__2__" data-uid="AiDotNet.MetaLearning.Algorithms.MetaSGDAlgorithm`3.#ctor(AiDotNet.MetaLearning.Options.MetaSGDOptions{`0,`1,`2})">
  MetaSGDAlgorithm(MetaSGDOptions&lt;T, TInput, TOutput&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/MetaLearning/Algorithms/MetaSGDAlgorithm.cs/#L133"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Initializes a new instance of the MetaSGDAlgorithm class.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public MetaSGDAlgorithm(MetaSGDOptions&lt;T, TInput, TOutput&gt; options)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>options</code> <a class="xref" href="AiDotNet.MetaLearning.Options.MetaSGDOptions-3.html">MetaSGDOptions</a>&lt;T, TInput, TOutput&gt;</dt>
    <dd><p>Meta-SGD configuration options containing the model and all hyperparameters.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3__ctor_AiDotNet_MetaLearning_Options_MetaSGDOptions__0__1__2___examples">Examples</h4>
  <pre><code class="lang-csharp">// Create Meta-SGD with minimal configuration
var options = new MetaSGDOptions&lt;double, Tensor, Tensor&gt;(myNeuralNetwork);
var metaSGD = new MetaSGDAlgorithm&lt;double, Tensor, Tensor&gt;(options);

// Create Meta-SGD with full per-parameter optimization
var options = new MetaSGDOptions&lt;double, Tensor, Tensor&gt;(myNeuralNetwork)
{
    UpdateRuleType = MetaSGDUpdateRuleType.Adam,
    LearnLearningRate = true,
    LearnMomentum = true,
    LearnDirection = true,
    LearnAdamBetas = true
};
var metaSGD = new MetaSGDAlgorithm&lt;double, Tensor, Tensor&gt;(options);</code></pre>


  <h4 class="section" id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3__ctor_AiDotNet_MetaLearning_Options_MetaSGDOptions__0__1__2___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
<b>For Beginners:</b> This creates a Meta-SGD model that learns per-parameter optimizers:
</p>
<p>
<b>What Meta-SGD needs:</b>
- <b>MetaModel:</b> Neural network to be meta-trained (required)
- <b>UpdateRuleType:</b> Type of update rule to learn (SGD, Adam, etc.)
- <b>LearnLearningRate:</b> Whether to learn per-parameter learning rates (default: true)
- <b>LearnMomentum:</b> Whether to learn per-parameter momentum (default: false)
- <b>LearnDirection:</b> Whether to learn update direction sign (default: true)
</p>
<p>
<b>What makes it different from MAML:</b>
- MAML: Same learning rate for all parameters
- Meta-SGD: Different learning rate per parameter
- Meta-SGD learns optimizers, MAML learns initialization
- Meta-SGD is first-order (faster), MAML is second-order (more accurate)
</p>
</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentnullexception">ArgumentNullException</a></dt>
    <dd><p>Thrown when options is null.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.invalidoperationexception">InvalidOperationException</a></dt>
    <dd><p>Thrown when required components are not set in options.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentexception">ArgumentException</a></dt>
    <dd><p>Thrown when configuration validation fails.</p>
</dd>
  </dl>



  <h2 class="section" id="properties">Properties
</h2>


  <a id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3_AlgorithmType_" data-uid="AiDotNet.MetaLearning.Algorithms.MetaSGDAlgorithm`3.AlgorithmType*"></a>

  <h3 id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3_AlgorithmType" data-uid="AiDotNet.MetaLearning.Algorithms.MetaSGDAlgorithm`3.AlgorithmType">
  AlgorithmType
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/MetaLearning/Algorithms/MetaSGDAlgorithm.cs/#L178"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets the algorithm type identifier for this meta-learner.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public override MetaLearningAlgorithmType AlgorithmType { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.MetaLearning.MetaLearningAlgorithmType.html">MetaLearningAlgorithmType</a></dt>
    <dd><p>Returns <a class="xref" href="AiDotNet.MetaLearning.MetaLearningAlgorithmType.html#AiDotNet_MetaLearning_MetaLearningAlgorithmType_MetaSGD">MetaSGD</a>.</p>
</dd>
  </dl>




  <h4 class="section" id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3_AlgorithmType_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
This property identifies the algorithm as Meta-SGD, a first-order meta-learning
algorithm that learns per-parameter learning rates, momentum terms, and update
directions for fast task adaptation.
</p>
<p>
<b>For Beginners:</b> This tells the framework which meta-learning algorithm
is being used. Meta-SGD is characterized by its per-parameter optimization
approach, which is simpler and faster than MAML while achieving competitive
performance on few-shot learning tasks.
</p>
</div>




  <h2 class="section" id="methods">Methods
</h2>


  <a id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3_Adapt_" data-uid="AiDotNet.MetaLearning.Algorithms.MetaSGDAlgorithm`3.Adapt*"></a>

  <h3 id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3_Adapt_AiDotNet_Interfaces_IMetaLearningTask__0__1__2__" data-uid="AiDotNet.MetaLearning.Algorithms.MetaSGDAlgorithm`3.Adapt(AiDotNet.Interfaces.IMetaLearningTask{`0,`1,`2})">
  Adapt(IMetaLearningTask&lt;T, TInput, TOutput&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/MetaLearning/Algorithms/MetaSGDAlgorithm.cs/#L270"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Adapts the meta-learned model to a new task using the learned per-parameter optimizers.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public override IModel&lt;TInput, TOutput, ModelMetadata&lt;T&gt;&gt; Adapt(IMetaLearningTask&lt;T, TInput, TOutput&gt; task)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>task</code> <a class="xref" href="AiDotNet.Interfaces.IMetaLearningTask-3.html">IMetaLearningTask</a>&lt;T, TInput, TOutput&gt;</dt>
    <dd><p>The new task containing support set examples for adaptation.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Interfaces.IModel-3.html">IModel</a>&lt;TInput, TOutput, <a class="xref" href="AiDotNet.Models.ModelMetadata-1.html">ModelMetadata</a>&lt;T&gt;&gt;</dt>
    <dd><p>A new model instance that has been adapted to the given task using learned optimizers.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3_Adapt_AiDotNet_Interfaces_IMetaLearningTask__0__1__2___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
Meta-SGD adaptation uses the learned per-parameter learning rates, momentum,
and directions to perform highly optimized gradient descent on the support set.
</p>
<p>
<b>For Beginners:</b> When adapting to a new task, Meta-SGD uses the learned
per-parameter optimizers to update the model. Each weight gets updated at its
own optimal rate, making adaptation much faster than using a single learning
rate for all weights.
</p>
<p>
<b>Adaptation Process:</b>
<pre><code class="lang-csharp">for each adaptation step:
    gradients = compute_gradients(model, support_set)
    for each parameter i:
        update_i = α_i × d_i × gradients[i] + β_i × velocity[i]
        params[i] = params[i] - update_i</code></pre>
<p>Where α_i, d_i, β_i are the learned per-parameter coefficients.</p>

<p>
<b>Advantages over MAML adaptation:</b>
- Uses optimized per-parameter learning rates (not one rate for all)
- Can include learned momentum for faster convergence
- Direction coefficients can flip/scale gradients as needed
</p>
</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentnullexception">ArgumentNullException</a></dt>
    <dd><p>Thrown when task is null.</p>
</dd>
  </dl>



  <a id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3_MetaTrain_" data-uid="AiDotNet.MetaLearning.Algorithms.MetaSGDAlgorithm`3.MetaTrain*"></a>

  <h3 id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3_MetaTrain_AiDotNet_MetaLearning_Data_TaskBatch__0__1__2__" data-uid="AiDotNet.MetaLearning.Algorithms.MetaSGDAlgorithm`3.MetaTrain(AiDotNet.MetaLearning.Data.TaskBatch{`0,`1,`2})">
  MetaTrain(TaskBatch&lt;T, TInput, TOutput&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/MetaLearning/Algorithms/MetaSGDAlgorithm.cs/#L215"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Performs one meta-training step using Meta-SGD's per-parameter optimization approach.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public override T MetaTrain(TaskBatch&lt;T, TInput, TOutput&gt; taskBatch)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>taskBatch</code> <a class="xref" href="AiDotNet.MetaLearning.Data.TaskBatch-3.html">TaskBatch</a>&lt;T, TInput, TOutput&gt;</dt>
    <dd><p>A batch of tasks to meta-train on, each containing support and query sets.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><span class="xref">T</span></dt>
    <dd><p>The average loss across all tasks in the batch (evaluated on query sets).</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_MetaLearning_Algorithms_MetaSGDAlgorithm_3_MetaTrain_AiDotNet_MetaLearning_Data_TaskBatch__0__1__2___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
Meta-SGD meta-training optimizes per-parameter learning coefficients:
</p>
<p>
<b>For each task:</b>
1. Clone the meta-model with current meta-parameters
2. Perform K gradient descent steps using learned per-parameter optimizers
3. Evaluate adapted model on query set
</p>
<p>
<b>Meta-Update:</b>
1. Compute gradients of query loss w.r.t. per-parameter coefficients
2. Update learning rates: α_i = α_i - η × ∂L_query/∂α_i
3. Update momentum (if enabled): β_i = β_i - η × ∂L_query/∂β_i
4. Update direction (if enabled): d_i = d_i - η × ∂L_query/∂d_i
</p>
<p>
<b>For Beginners:</b> Meta-SGD learns how fast each weight should change.
After seeing many tasks, it discovers that some weights need big updates
(high learning rate) while others need small updates (low learning rate).
This makes adaptation to new tasks much faster and more effective.
</p>
<p>
<b>Key Difference from MAML:</b> While MAML computes how initialization
affects final loss (requires second-order gradients), Meta-SGD directly
learns the optimal update magnitude for each parameter (first-order only).
</p>
</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentexception">ArgumentException</a></dt>
    <dd><p>Thrown when the task batch is null or empty.</p>
</dd>
  </dl>




</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ooples/AiDotNet/blob/master/src/MetaLearning/Algorithms/MetaSGDAlgorithm.cs/#L83" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          AiDotNet - Enterprise AI/ML Library for .NET
        </div>
      </div>
    </footer>
  </body>
</html>
