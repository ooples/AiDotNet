<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class MetaOptNetAlgorithm&lt;T, TInput, TOutput&gt; | AiDotNet Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class MetaOptNetAlgorithm&lt;T, TInput, TOutput&gt; | AiDotNet Documentation ">
      
      <meta name="description" content="Implementation of Meta-learning with Differentiable Convex Optimization (MetaOptNet) algorithm.">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ooples/AiDotNet/new/master/apiSpec/new?filename=AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3.md&amp;value=---%0Auid%3A%20AiDotNet.MetaLearning.Algorithms.MetaOptNetAlgorithm%603%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="AiDotNet">
            AiDotNet
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="AiDotNet.MetaLearning.Algorithms.MetaOptNetAlgorithm`3">



  <h1 id="AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3" data-uid="AiDotNet.MetaLearning.Algorithms.MetaOptNetAlgorithm`3" class="text-break">
Class MetaOptNetAlgorithm&lt;T, TInput, TOutput&gt;  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/MetaLearning/Algorithms/MetaOptNetAlgorithm.cs/#L66"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="AiDotNet.html">AiDotNet</a>.<a class="xref" href="AiDotNet.MetaLearning.html">MetaLearning</a>.<a class="xref" href="AiDotNet.MetaLearning.Algorithms.html">Algorithms</a></dd></dl>
  <dl><dt>Assembly</dt><dd>AiDotNet.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Implementation of Meta-learning with Differentiable Convex Optimization (MetaOptNet) algorithm.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class MetaOptNetAlgorithm&lt;T, TInput, TOutput&gt; : MetaLearnerBase&lt;T, TInput, TOutput&gt;, IMetaLearner&lt;T, TInput, TOutput&gt;</code></pre>
  </div>



  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type used for calculations (e.g., double, float).</p>
</dd>
    <dt><code>TInput</code></dt>
    <dd><p>The input data type (e.g., Matrix&lt;T&gt;, Tensor&lt;T&gt;).</p>
</dd>
    <dt><code>TOutput</code></dt>
    <dd><p>The output data type (e.g., Vector&lt;T&gt;, Tensor&lt;T&gt;).</p>
</dd>
  </dl>

  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html">MetaLearnerBase</a>&lt;T, TInput, TOutput&gt;</div>
      <div><span class="xref">MetaOptNetAlgorithm&lt;T, TInput, TOutput&gt;</span></div>
    </dd>
  </dl>

  <dl class="typelist implements">
    <dt>Implements</dt>
    <dd>
      <div><a class="xref" href="AiDotNet.Interfaces.IMetaLearner-3.html">IMetaLearner</a>&lt;T, TInput, TOutput&gt;</div>
    </dd>
  </dl>


  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_MetaModel">MetaLearnerBase&lt;T, TInput, TOutput&gt;.MetaModel</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_LossFunction">MetaLearnerBase&lt;T, TInput, TOutput&gt;.LossFunction</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3__options">MetaLearnerBase&lt;T, TInput, TOutput&gt;._options</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_DataLoader">MetaLearnerBase&lt;T, TInput, TOutput&gt;.DataLoader</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_NumOps">MetaLearnerBase&lt;T, TInput, TOutput&gt;.NumOps</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_RandomGenerator">MetaLearnerBase&lt;T, TInput, TOutput&gt;.RandomGenerator</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_MetaOptimizer">MetaLearnerBase&lt;T, TInput, TOutput&gt;.MetaOptimizer</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_InnerOptimizer">MetaLearnerBase&lt;T, TInput, TOutput&gt;.InnerOptimizer</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3__currentIteration">MetaLearnerBase&lt;T, TInput, TOutput&gt;._currentIteration</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Engine">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Engine</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_BaseModel">MetaLearnerBase&lt;T, TInput, TOutput&gt;.BaseModel</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Options">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Options</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_CurrentIteration">MetaLearnerBase&lt;T, TInput, TOutput&gt;.CurrentIteration</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_AlgorithmType">MetaLearnerBase&lt;T, TInput, TOutput&gt;.AlgorithmType</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_AdaptationSteps">MetaLearnerBase&lt;T, TInput, TOutput&gt;.AdaptationSteps</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_InnerLearningRate">MetaLearnerBase&lt;T, TInput, TOutput&gt;.InnerLearningRate</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_OuterLearningRate">MetaLearnerBase&lt;T, TInput, TOutput&gt;.OuterLearningRate</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_MetaTrain_AiDotNet_MetaLearning_Data_TaskBatch__0__1__2__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.MetaTrain(TaskBatch&lt;T, TInput, TOutput&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Adapt_AiDotNet_Interfaces_IMetaLearningTask__0__1__2__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Adapt(IMetaLearningTask&lt;T, TInput, TOutput&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Evaluate_AiDotNet_MetaLearning_Data_TaskBatch__0__1__2__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Evaluate(TaskBatch&lt;T, TInput, TOutput&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_MetaTrainStep_System_Int32_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.MetaTrainStep(int)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Train">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Train()</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Evaluate_System_Int32_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Evaluate(int)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_AdaptAndEvaluate_AiDotNet_Data_Structures_MetaLearningTask__0__1__2__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.AdaptAndEvaluate(MetaLearningTask&lt;T, TInput, TOutput&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_GetMetaModel">MetaLearnerBase&lt;T, TInput, TOutput&gt;.GetMetaModel()</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_SetMetaModel_AiDotNet_Interfaces_IFullModel__0__1__2__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.SetMetaModel(IFullModel&lt;T, TInput, TOutput&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Save_System_String_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Save(string)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Load_System_String_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Load(string)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_Reset">MetaLearnerBase&lt;T, TInput, TOutput&gt;.Reset()</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ComputeGradients_AiDotNet_Interfaces_IFullModel__0__1__2___1__2_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ComputeGradients(IFullModel&lt;T, TInput, TOutput&gt;, TInput, TOutput)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ComputeSecondOrderGradients_AiDotNet_Interfaces_IFullModel__0__1__2__System_Collections_Generic_List_System_ValueTuple__1__2____1__2__0_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ComputeSecondOrderGradients(IFullModel&lt;T, TInput, TOutput&gt;, List&lt;(TInput input, TOutput target)&gt;, TInput, TOutput, T)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ApplyGradients_AiDotNet_Tensors_LinearAlgebra_Vector__0__AiDotNet_Tensors_LinearAlgebra_Vector__0__System_Double_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ApplyGradients(Vector&lt;T&gt;, Vector&lt;T&gt;, double)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ClipGradients_AiDotNet_Tensors_LinearAlgebra_Vector__0__System_Nullable_System_Double__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ClipGradients(Vector&lt;T&gt;, double?)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_CreateTaskBatch_System_Collections_Generic_IReadOnlyList_AiDotNet_Data_Structures_MetaLearningTask__0__1__2___">MetaLearnerBase&lt;T, TInput, TOutput&gt;.CreateTaskBatch(IReadOnlyList&lt;MetaLearningTask&lt;T, TInput, TOutput&gt;&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ToMetaLearningTask_AiDotNet_Data_Structures_MetaLearningTask__0__1__2__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ToMetaLearningTask(MetaLearningTask&lt;T, TInput, TOutput&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ComputeAccuracy__2__2_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ComputeAccuracy(TOutput, TOutput)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ComputeLossFromOutput__2__2_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ComputeLossFromOutput(TOutput, TOutput)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ConvertToVector__2_">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ConvertToVector(TOutput)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_ComputeMean_System_Collections_Generic_List__0__">MetaLearnerBase&lt;T, TInput, TOutput&gt;.ComputeMean(List&lt;T&gt;)</a>
    </div>
    <div>
      <a class="xref" href="AiDotNet.MetaLearning.MetaLearnerBase-3.html#AiDotNet_MetaLearning_MetaLearnerBase_3_CloneModel">MetaLearnerBase&lt;T, TInput, TOutput&gt;.CloneModel()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>




  <h2 id="AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p>
MetaOptNet replaces the gradient-based inner-loop optimization of MAML with a
differentiable convex optimization solver. This provides several advantages:
</p>
<ul><li>Closed-form solution (no iterative optimization)</li><li>Theoretically guaranteed convergence</li><li>Stable training dynamics</li><li>Differentiable through implicit function theorem</li></ul>
<p>
<b>Key Innovation:</b> Instead of gradient descent in the inner loop:
</p>
<pre><code class="lang-csharp">MAML inner loop: θ' = θ - α∇L(θ)  (repeat k times)
MetaOptNet:      w* = argmin_w L(w) + λR(w)  (closed-form!)</code></pre>
<p>
<b>For Beginners:</b> Imagine you're trying to fit a line to some points.
MAML would iteratively adjust the line: "move a bit left, now a bit right..."
MetaOptNet uses math to find the exact best line in one shot using the formula:
w = (X^T X + λI)^(-1) X^T y
</p>
<p>
<b>Supported Solvers:</b>
- Ridge Regression: Fast, closed-form, good for most tasks
- SVM: More powerful, better margins, but slower
- Logistic Regression: For probabilistic outputs
</p>
<p>
<b>Algorithm:</b>
<pre><code class="lang-csharp">For each task batch:
  For each task:
    1. Extract embeddings from support set: Z_s = f(X_s)
    2. Solve convex problem: w* = Solver(Z_s, Y_s, λ)
    3. Classify query set: Y_q = Z_q × w*
    4. Compute query loss
  Meta-update encoder f using gradients through the solver</code></pre>

<p>
Reference: Lee, K., Maji, S., Ravichandran, A., &amp; Soatto, S. (2019).
Meta-Learning with Differentiable Convex Optimization. CVPR 2019.
</p>
</div>


  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3__ctor_" data-uid="AiDotNet.MetaLearning.Algorithms.MetaOptNetAlgorithm`3.#ctor*"></a>

  <h3 id="AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3__ctor_AiDotNet_MetaLearning_Options_MetaOptNetOptions__0__1__2__" data-uid="AiDotNet.MetaLearning.Algorithms.MetaOptNetAlgorithm`3.#ctor(AiDotNet.MetaLearning.Options.MetaOptNetOptions{`0,`1,`2})">
  MetaOptNetAlgorithm(MetaOptNetOptions&lt;T, TInput, TOutput&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/MetaLearning/Algorithms/MetaOptNetAlgorithm.cs/#L95"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Initializes a new instance of the MetaOptNetAlgorithm class.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public MetaOptNetAlgorithm(MetaOptNetOptions&lt;T, TInput, TOutput&gt; options)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>options</code> <a class="xref" href="AiDotNet.MetaLearning.Options.MetaOptNetOptions-3.html">MetaOptNetOptions</a>&lt;T, TInput, TOutput&gt;</dt>
    <dd><p>MetaOptNet configuration options containing the model and all hyperparameters.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3__ctor_AiDotNet_MetaLearning_Options_MetaOptNetOptions__0__1__2___examples">Examples</h4>
  <pre><code class="lang-csharp">// Create MetaOptNet with minimal configuration
var options = new MetaOptNetOptions&lt;double, Tensor, Tensor&gt;(myNeuralNetwork);
var metaOptNet = new MetaOptNetAlgorithm&lt;double, Tensor, Tensor&gt;(options);

// Create MetaOptNet with SVM solver
var options = new MetaOptNetOptions&lt;double, Tensor, Tensor&gt;(myNeuralNetwork)
{
    SolverType = ConvexSolverType.SVM,
    RegularizationStrength = 1.0,
    NumClasses = 5
};
var metaOptNet = new MetaOptNetAlgorithm&lt;double, Tensor, Tensor&gt;(options);</code></pre>



  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentnullexception">ArgumentNullException</a></dt>
    <dd><p>Thrown when options is null.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.invalidoperationexception">InvalidOperationException</a></dt>
    <dd><p>Thrown when required components are not set in options.</p>
</dd>
  </dl>



  <h2 class="section" id="properties">Properties
</h2>


  <a id="AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3_AlgorithmType_" data-uid="AiDotNet.MetaLearning.Algorithms.MetaOptNetAlgorithm`3.AlgorithmType*"></a>

  <h3 id="AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3_AlgorithmType" data-uid="AiDotNet.MetaLearning.Algorithms.MetaOptNetAlgorithm`3.AlgorithmType">
  AlgorithmType
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/MetaLearning/Algorithms/MetaOptNetAlgorithm.cs/#L118"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets the algorithm type identifier for this meta-learner.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public override MetaLearningAlgorithmType AlgorithmType { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.MetaLearning.MetaLearningAlgorithmType.html">MetaLearningAlgorithmType</a></dt>
    <dd><p>Returns <a class="xref" href="AiDotNet.MetaLearning.MetaLearningAlgorithmType.html#AiDotNet_MetaLearning_MetaLearningAlgorithmType_MetaOptNet">MetaOptNet</a>.</p>
</dd>
  </dl>




  <h4 class="section" id="AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3_AlgorithmType_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
This property identifies the algorithm as MetaOptNet, which uses differentiable
convex optimization in the inner loop for meta-learning.
</p>
</div>




  <h2 class="section" id="methods">Methods
</h2>


  <a id="AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3_Adapt_" data-uid="AiDotNet.MetaLearning.Algorithms.MetaOptNetAlgorithm`3.Adapt*"></a>

  <h3 id="AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3_Adapt_AiDotNet_Interfaces_IMetaLearningTask__0__1__2__" data-uid="AiDotNet.MetaLearning.Algorithms.MetaOptNetAlgorithm`3.Adapt(AiDotNet.Interfaces.IMetaLearningTask{`0,`1,`2})">
  Adapt(IMetaLearningTask&lt;T, TInput, TOutput&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/MetaLearning/Algorithms/MetaOptNetAlgorithm.cs/#L295"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Adapts the meta-learned model to a new task using convex optimization.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public override IModel&lt;TInput, TOutput, ModelMetadata&lt;T&gt;&gt; Adapt(IMetaLearningTask&lt;T, TInput, TOutput&gt; task)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>task</code> <a class="xref" href="AiDotNet.Interfaces.IMetaLearningTask-3.html">IMetaLearningTask</a>&lt;T, TInput, TOutput&gt;</dt>
    <dd><p>The new task containing support set examples for adaptation.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Interfaces.IModel-3.html">IModel</a>&lt;TInput, TOutput, <a class="xref" href="AiDotNet.Models.ModelMetadata-1.html">ModelMetadata</a>&lt;T&gt;&gt;</dt>
    <dd><p>A new model instance that has been adapted to the given task.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3_Adapt_AiDotNet_Interfaces_IMetaLearningTask__0__1__2___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
MetaOptNet adaptation is extremely fast because it uses a closed-form solution:
</p>
<ol><li>Extract embeddings from support examples</li><li>Solve convex optimization for classifier weights</li><li>Return model with encoder + classifier</li></ol>
<p>
<b>For Beginners:</b> Adaptation is instant! We just:
1. Transform support examples into feature space
2. Use a mathematical formula to find the best classifier
3. Done! No gradient steps needed.
</p>
<p>
<b>Speed Comparison:</b>
- MAML: ~10 gradient steps at test time
- MetaOptNet: 1 matrix inversion (constant time)
</p>
</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentnullexception">ArgumentNullException</a></dt>
    <dd><p>Thrown when task is null.</p>
</dd>
  </dl>



  <a id="AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3_MetaTrain_" data-uid="AiDotNet.MetaLearning.Algorithms.MetaOptNetAlgorithm`3.MetaTrain*"></a>

  <h3 id="AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3_MetaTrain_AiDotNet_MetaLearning_Data_TaskBatch__0__1__2__" data-uid="AiDotNet.MetaLearning.Algorithms.MetaOptNetAlgorithm`3.MetaTrain(AiDotNet.MetaLearning.Data.TaskBatch{`0,`1,`2})">
  MetaTrain(TaskBatch&lt;T, TInput, TOutput&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/MetaLearning/Algorithms/MetaOptNetAlgorithm.cs/#L159"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Performs one meta-training step using MetaOptNet's convex optimization approach.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public override T MetaTrain(TaskBatch&lt;T, TInput, TOutput&gt; taskBatch)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>taskBatch</code> <a class="xref" href="AiDotNet.MetaLearning.Data.TaskBatch-3.html">TaskBatch</a>&lt;T, TInput, TOutput&gt;</dt>
    <dd><p>A batch of tasks to meta-train on, each containing support and query sets.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><span class="xref">T</span></dt>
    <dd><p>The average meta-loss across all tasks in the batch (evaluated on query sets).</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_MetaLearning_Algorithms_MetaOptNetAlgorithm_3_MetaTrain_AiDotNet_MetaLearning_Data_TaskBatch__0__1__2___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>
MetaOptNet meta-training differs from MAML in the inner loop:
</p>
<p>
<b>MetaOptNet Training Loop:</b>
<pre><code class="lang-csharp">For each task:
  1. Extract embeddings: Z_s = f_θ(X_s), Z_q = f_θ(X_q)
  2. Solve for classifier: w* = ConvexSolver(Z_s, Y_s)
  3. Classify query: logits = Z_q × w* / τ  (τ = temperature)
  4. Compute loss: L = CrossEntropy(softmax(logits), Y_q)
Update encoder θ using gradients through the solver</code></pre>

<p>
<b>Key Difference from MAML:</b>
- MAML: Gradients flow through the optimization trajectory
- MetaOptNet: Gradients flow through the implicit function at the optimum
</p>
<p>
The implicit gradient computation uses:
∂w*/∂θ = -(H^-1) × (∂²L/∂w∂θ)
where H is the Hessian of the inner objective.
</p>
<p>
<b>For Beginners:</b> MetaOptNet learns a feature extractor that produces
embeddings where simple classifiers work well. The convex solver finds
the best simple classifier, and we update the feature extractor to make
this classifier work even better on the query set.
</p>
</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentexception">ArgumentException</a></dt>
    <dd><p>Thrown when the task batch is null or empty.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.invalidoperationexception">InvalidOperationException</a></dt>
    <dd><p>Thrown when meta-gradient computation fails.</p>
</dd>
  </dl>




</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ooples/AiDotNet/blob/master/src/MetaLearning/Algorithms/MetaOptNetAlgorithm.cs/#L66" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          AiDotNet - Enterprise AI/ML Library for .NET
        </div>
      </div>
    </footer>
  </body>
</html>
