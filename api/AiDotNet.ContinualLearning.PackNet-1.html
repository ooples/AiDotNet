<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class PackNet&lt;T&gt; | AiDotNet Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class PackNet&lt;T&gt; | AiDotNet Documentation ">
      
      <meta name="description" content="Implements PackNet for continual learning through parameter isolation.">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ooples/AiDotNet/new/master/apiSpec/new?filename=AiDotNet_ContinualLearning_PackNet_1.md&amp;value=---%0Auid%3A%20AiDotNet.ContinualLearning.PackNet%601%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="AiDotNet">
            AiDotNet
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="AiDotNet.ContinualLearning.PackNet`1">



  <h1 id="AiDotNet_ContinualLearning_PackNet_1" data-uid="AiDotNet.ContinualLearning.PackNet`1" class="text-break">
Class PackNet&lt;T&gt;  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L43"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="AiDotNet.html">AiDotNet</a>.<a class="xref" href="AiDotNet.ContinualLearning.html">ContinualLearning</a></dd></dl>
  <dl><dt>Assembly</dt><dd>AiDotNet.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Implements PackNet for continual learning through parameter isolation.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class PackNet&lt;T&gt; : IContinualLearningStrategy&lt;T&gt;</code></pre>
  </div>



  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type for calculations.</p>
</dd>
  </dl>

  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">PackNet&lt;T&gt;</span></div>
    </dd>
  </dl>

  <dl class="typelist implements">
    <dt>Implements</dt>
    <dd>
      <div><a class="xref" href="AiDotNet.Interfaces.IContinualLearningStrategy-1.html">IContinualLearningStrategy</a>&lt;T&gt;</div>
    </dd>
  </dl>


  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>




  <h2 id="AiDotNet_ContinualLearning_PackNet_1_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p><b>For Beginners:</b> PackNet achieves continual learning by dynamically pruning
and freezing network weights. After learning each task, unimportant weights are pruned,
and the remaining weights are frozen. New tasks can only use the pruned (free) weights,
effectively isolating each task's parameters.</p>
<p><b>How it works:</b></p>
<ol><li>Train the network on Task 1 using all available weights.</li><li>After training, prune weights with smallest magnitude (keep top k%).</li><li>Freeze the remaining (important) weights - they now belong to Task 1.</li><li>For Task 2, only train on the pruned (free) weights.</li><li>Repeat: prune, freeze, move to next task.</li></ol>
<p><b>Key Concepts:</b></p>
<ul><li><b>Free Weights:</b> Weights available for the current task (pruned in previous tasks).</li><li><b>Frozen Weights:</b> Weights dedicated to previous tasks (cannot be modified).</li><li><b>Pruning Ratio:</b> Percentage of free weights to prune after each task.</li></ul>
<p><b>Advantages:</b></p>
<ul><li>Zero forgetting - previous task weights are completely protected.</li><li>No replay or regularization needed during training.</li><li>Network compression as a side effect of pruning.</li></ul>
<p><b>Reference:</b> Mallya, A. and Lazebnik, S. "PackNet: Adding Multiple Tasks to a
Single Network by Iterative Pruning" (2018). CVPR.</p>
</div>


  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="AiDotNet_ContinualLearning_PackNet_1__ctor_" data-uid="AiDotNet.ContinualLearning.PackNet`1.#ctor*"></a>

  <h3 id="AiDotNet_ContinualLearning_PackNet_1__ctor_System_Double_System_Double_" data-uid="AiDotNet.ContinualLearning.PackNet`1.#ctor(System.Double,System.Double)">
  PackNet(double, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L66"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Initializes a new instance of the PackNet class.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public PackNet(double pruningRatio = 0.5, double lambda = 1000)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>pruningRatio</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Ratio of weights to prune after each task (default: 0.5 = 50%).</p>
</dd>
    <dt><code>lambda</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Strength of weight freezing enforcement (default: 1000.0).</p>
</dd>
  </dl>








  <h4 class="section" id="AiDotNet_ContinualLearning_PackNet_1__ctor_System_Double_System_Double__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b></p>
<ul><li>Pruning ratio determines how much of the remaining capacity to use per task.</li><li>With ratio 0.5, you can fit approximately log2(1/ratio) tasks before running out.</li><li>Lambda should be very high to enforce weight freezing.</li></ul>
</div>




  <h2 class="section" id="properties">Properties
</h2>


  <a id="AiDotNet_ContinualLearning_PackNet_1_FreeWeightCount_" data-uid="AiDotNet.ContinualLearning.PackNet`1.FreeWeightCount*"></a>

  <h3 id="AiDotNet_ContinualLearning_PackNet_1_FreeWeightCount" data-uid="AiDotNet.ContinualLearning.PackNet`1.FreeWeightCount">
  FreeWeightCount
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L103"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets the number of free weights available for new tasks.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public int FreeWeightCount { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd></dd>
  </dl>








  <a id="AiDotNet_ContinualLearning_PackNet_1_Lambda_" data-uid="AiDotNet.ContinualLearning.PackNet`1.Lambda*"></a>

  <h3 id="AiDotNet_ContinualLearning_PackNet_1_Lambda" data-uid="AiDotNet.ContinualLearning.PackNet`1.Lambda">
  Lambda
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L84"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets the regularization strength parameter (lambda) for loss-based continual learning.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public double Lambda { get; set; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd></dd>
  </dl>




  <h4 class="section" id="AiDotNet_ContinualLearning_PackNet_1_Lambda_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> Lambda controls how strongly the strategy prevents forgetting.
A higher lambda means the network is more conservative about changing weights important
for previous tasks, but this might make it harder to learn new tasks effectively.</p>
<p>Typical values range from 100 to 10000, depending on the complexity of tasks
and how important it is to preserve old knowledge versus learning new knowledge.</p>
</div>




  <a id="AiDotNet_ContinualLearning_PackNet_1_PruningRatio_" data-uid="AiDotNet.ContinualLearning.PackNet`1.PruningRatio*"></a>

  <h3 id="AiDotNet_ContinualLearning_PackNet_1_PruningRatio" data-uid="AiDotNet.ContinualLearning.PackNet`1.PruningRatio">
  PruningRatio
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L98"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets the pruning ratio.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public double PruningRatio { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd></dd>
  </dl>








  <a id="AiDotNet_ContinualLearning_PackNet_1_TaskCount_" data-uid="AiDotNet.ContinualLearning.PackNet`1.TaskCount*"></a>

  <h3 id="AiDotNet_ContinualLearning_PackNet_1_TaskCount" data-uid="AiDotNet.ContinualLearning.PackNet`1.TaskCount">
  TaskCount
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L93"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets the number of tasks stored.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public int TaskCount { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd></dd>
  </dl>








  <a id="AiDotNet_ContinualLearning_PackNet_1_TotalParameters_" data-uid="AiDotNet.ContinualLearning.PackNet`1.TotalParameters*"></a>

  <h3 id="AiDotNet_ContinualLearning_PackNet_1_TotalParameters" data-uid="AiDotNet.ContinualLearning.PackNet`1.TotalParameters">
  TotalParameters
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L108"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets the total parameter count.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public int TotalParameters { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd></dd>
  </dl>








  <h2 class="section" id="methods">Methods
</h2>


  <a id="AiDotNet_ContinualLearning_PackNet_1_AfterTask_" data-uid="AiDotNet.ContinualLearning.PackNet`1.AfterTask*"></a>

  <h3 id="AiDotNet_ContinualLearning_PackNet_1_AfterTask_AiDotNet_Interfaces_INeuralNetwork__0__System_ValueTuple_AiDotNet_Tensors_LinearAlgebra_Tensor__0__AiDotNet_Tensors_LinearAlgebra_Tensor__0___System_Int32_" data-uid="AiDotNet.ContinualLearning.PackNet`1.AfterTask(AiDotNet.Interfaces.INeuralNetwork{`0},System.ValueTuple{AiDotNet.Tensors.LinearAlgebra.Tensor{`0},AiDotNet.Tensors.LinearAlgebra.Tensor{`0}},System.Int32)">
  AfterTask(INeuralNetwork&lt;T&gt;, (Tensor&lt;T&gt; inputs, Tensor&lt;T&gt; targets), int)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L126"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Processes information after completing training on a task.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void AfterTask(INeuralNetwork&lt;T&gt; network, (Tensor&lt;T&gt; inputs, Tensor&lt;T&gt; targets) taskData, int taskId)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>network</code> <a class="xref" href="AiDotNet.Interfaces.INeuralNetwork-1.html">INeuralNetwork</a>&lt;T&gt;</dt>
    <dd><p>The neural network that was trained.</p>
</dd>
    <dt><code>taskData</code> (<a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt; <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-aidotnet.tensors.linearalgebra.tensor--0-,aidotnet.tensors.linearalgebra.tensor--0--.grad1">grad1</a>, <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt; <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-aidotnet.tensors.linearalgebra.tensor--0-,aidotnet.tensors.linearalgebra.tensor--0--.grad2">grad2</a>)</dt>
    <dd><p>Data from the completed task for computing importance measures.</p>
</dd>
    <dt><code>taskId</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The identifier for the completed task.</p>
</dd>
  </dl>








  <h4 class="section" id="AiDotNet_ContinualLearning_PackNet_1_AfterTask_AiDotNet_Interfaces_INeuralNetwork__0__System_ValueTuple_AiDotNet_Tensors_LinearAlgebra_Tensor__0__AiDotNet_Tensors_LinearAlgebra_Tensor__0___System_Int32__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This method is called after you finish training on a task.
It allows the strategy to compute and store information about what the network learned,
which will be used to protect this knowledge when learning future tasks.</p>
<p>For example, in Elastic Weight Consolidation (EWC), this computes the Fisher
Information Matrix to identify which weights are most important for the completed task.</p>
</div>




  <a id="AiDotNet_ContinualLearning_PackNet_1_ApplyTaskMask_" data-uid="AiDotNet.ContinualLearning.PackNet`1.ApplyTaskMask*"></a>

  <h3 id="AiDotNet_ContinualLearning_PackNet_1_ApplyTaskMask_AiDotNet_Interfaces_INeuralNetwork__0__System_Int32_" data-uid="AiDotNet.ContinualLearning.PackNet`1.ApplyTaskMask(AiDotNet.Interfaces.INeuralNetwork{`0},System.Int32)">
  ApplyTaskMask(INeuralNetwork&lt;T&gt;, int)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L196"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Applies the task-specific mask to network parameters for inference.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void ApplyTaskMask(INeuralNetwork&lt;T&gt; network, int taskId)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>network</code> <a class="xref" href="AiDotNet.Interfaces.INeuralNetwork-1.html">INeuralNetwork</a>&lt;T&gt;</dt>
    <dd><p>The neural network.</p>
</dd>
    <dt><code>taskId</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The task to configure for.</p>
</dd>
  </dl>








  <h4 class="section" id="AiDotNet_ContinualLearning_PackNet_1_ApplyTaskMask_AiDotNet_Interfaces_INeuralNetwork__0__System_Int32__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>This zeros out weights that don't belong to the specified task,
which is useful for task-specific inference.</p>
</div>




  <a id="AiDotNet_ContinualLearning_PackNet_1_BeforeTask_" data-uid="AiDotNet.ContinualLearning.PackNet`1.BeforeTask*"></a>

  <h3 id="AiDotNet_ContinualLearning_PackNet_1_BeforeTask_AiDotNet_Interfaces_INeuralNetwork__0__System_Int32_" data-uid="AiDotNet.ContinualLearning.PackNet`1.BeforeTask(AiDotNet.Interfaces.INeuralNetwork{`0},System.Int32)">
  BeforeTask(INeuralNetwork&lt;T&gt;, int)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L111"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Prepares the strategy before starting to learn a new task.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void BeforeTask(INeuralNetwork&lt;T&gt; network, int taskId)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>network</code> <a class="xref" href="AiDotNet.Interfaces.INeuralNetwork-1.html">INeuralNetwork</a>&lt;T&gt;</dt>
    <dd><p>The neural network that will be trained.</p>
</dd>
    <dt><code>taskId</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The identifier for the upcoming task (0-indexed).</p>
</dd>
  </dl>








  <h4 class="section" id="AiDotNet_ContinualLearning_PackNet_1_BeforeTask_AiDotNet_Interfaces_INeuralNetwork__0__System_Int32__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This method is called before you start training on a new task.
It allows the strategy to capture the network's current state or prepare any necessary
data structures for protecting knowledge from previous tasks.</p>
<p>For example, in Learning without Forgetting (LwF), this might store the network's
predictions on the new task's inputs before training begins, so we can later encourage
the network to maintain similar predictions.</p>
</div>




  <a id="AiDotNet_ContinualLearning_PackNet_1_ComputeLoss_" data-uid="AiDotNet.ContinualLearning.PackNet`1.ComputeLoss*"></a>

  <h3 id="AiDotNet_ContinualLearning_PackNet_1_ComputeLoss_AiDotNet_Interfaces_INeuralNetwork__0__" data-uid="AiDotNet.ContinualLearning.PackNet`1.ComputeLoss(AiDotNet.Interfaces.INeuralNetwork{`0})">
  ComputeLoss(INeuralNetwork&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L141"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Computes the regularization loss to prevent forgetting previous tasks.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public T ComputeLoss(INeuralNetwork&lt;T&gt; network)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>network</code> <a class="xref" href="AiDotNet.Interfaces.INeuralNetwork-1.html">INeuralNetwork</a>&lt;T&gt;</dt>
    <dd><p>The neural network being trained.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><span class="xref">T</span></dt>
    <dd><p>The regularization loss value that should be added to the task loss.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_ContinualLearning_PackNet_1_ComputeLoss_AiDotNet_Interfaces_INeuralNetwork__0___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This method calculates an additional loss term that penalizes
the network for deviating from its learned knowledge of previous tasks. You add this
to your regular task loss during training:</p>
<pre><code class="lang-csharp">var totalLoss = taskLoss + strategy.ComputeLoss(network);</code></pre>
<p>For example, in EWC, this returns a penalty proportional to how much important
weights have changed from their optimal values for previous tasks. Larger changes to
important weights result in higher loss, discouraging the network from forgetting.</p>
</div>




  <a id="AiDotNet_ContinualLearning_PackNet_1_GetTaskMask_" data-uid="AiDotNet.ContinualLearning.PackNet`1.GetTaskMask*"></a>

  <h3 id="AiDotNet_ContinualLearning_PackNet_1_GetTaskMask_System_Int32_" data-uid="AiDotNet.ContinualLearning.PackNet`1.GetTaskMask(System.Int32)">
  GetTaskMask(int)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L180"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets the weight mask for a specific task.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public HashSet&lt;int&gt; GetTaskMask(int taskId)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>taskId</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The task ID.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.hashset-1">HashSet</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a>&gt;</dt>
    <dd><p>Set of weight indices belonging to the task.</p>
</dd>
  </dl>











  <a id="AiDotNet_ContinualLearning_PackNet_1_GetWeightAllocationStats_" data-uid="AiDotNet.ContinualLearning.PackNet`1.GetWeightAllocationStats*"></a>

  <h3 id="AiDotNet_ContinualLearning_PackNet_1_GetWeightAllocationStats" data-uid="AiDotNet.ContinualLearning.PackNet`1.GetWeightAllocationStats">
  GetWeightAllocationStats()
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L268"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets statistics about weight allocation across tasks.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public Dictionary&lt;int, int&gt; GetWeightAllocationStats()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.dictionary-2">Dictionary</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a>&gt;</dt>
    <dd><p>Dictionary mapping task IDs to weight counts.</p>
</dd>
  </dl>











  <a id="AiDotNet_ContinualLearning_PackNet_1_ModifyGradients_" data-uid="AiDotNet.ContinualLearning.PackNet`1.ModifyGradients*"></a>

  <h3 id="AiDotNet_ContinualLearning_PackNet_1_ModifyGradients_AiDotNet_Interfaces_INeuralNetwork__0__AiDotNet_Tensors_LinearAlgebra_Vector__0__" data-uid="AiDotNet.ContinualLearning.PackNet`1.ModifyGradients(AiDotNet.Interfaces.INeuralNetwork{`0},AiDotNet.Tensors.LinearAlgebra.Vector{`0})">
  ModifyGradients(INeuralNetwork&lt;T&gt;, Vector&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L148"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Modifies the gradient to prevent catastrophic forgetting.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public Vector&lt;T&gt; ModifyGradients(INeuralNetwork&lt;T&gt; network, Vector&lt;T&gt; gradients)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>network</code> <a class="xref" href="AiDotNet.Interfaces.INeuralNetwork-1.html">INeuralNetwork</a>&lt;T&gt;</dt>
    <dd><p>The neural network being trained.</p>
</dd>
    <dt><code>gradients</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The gradients from the current task loss.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>Modified gradients that protect previous task knowledge.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_ContinualLearning_PackNet_1_ModifyGradients_AiDotNet_Interfaces_INeuralNetwork__0__AiDotNet_Tensors_LinearAlgebra_Vector__0___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> Some continual learning strategies work by modifying the
gradients (the update directions for weights) rather than adding a loss term.
This method takes the gradients computed from the current task and modifies them
to avoid interfering with previously learned tasks.</p>
<p>For example, in Gradient Episodic Memory (GEM), if a gradient would hurt
performance on stored examples from previous tasks, it's projected to the closest
gradient that doesn't interfere with those examples.</p>
<p>If a strategy doesn't use gradient modification, this should return the
gradients unchanged.</p>
</div>




  <a id="AiDotNet_ContinualLearning_PackNet_1_Reset_" data-uid="AiDotNet.ContinualLearning.PackNet`1.Reset*"></a>

  <h3 id="AiDotNet_ContinualLearning_PackNet_1_Reset" data-uid="AiDotNet.ContinualLearning.PackNet`1.Reset">
  Reset()
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L167"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Resets the strategy, clearing all stored task information.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void Reset()</code></pre>
  </div>









  <h4 class="section" id="AiDotNet_ContinualLearning_PackNet_1_Reset_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This method clears all the information the strategy has
accumulated about previous tasks. After calling this, the network will be free to
learn new tasks without any constraints from previously learned tasks.</p>
<p>Use this when you want to start fresh or when you're done with a sequence
of tasks and want to begin a new independent sequence.</p>
</div>





</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ooples/AiDotNet/blob/master/src/ContinualLearning/PackNet.cs/#L43" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          AiDotNet - Enterprise AI/ML Library for .NET
        </div>
      </div>
    </footer>
  </body>
</html>
