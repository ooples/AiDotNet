<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class MultiQueryExpansion | AiDotNet Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class MultiQueryExpansion | AiDotNet Documentation ">
      
      <meta name="description" content="Expands queries by generating multiple query variations from different perspectives using LLM-based reformulation.">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ooples/AiDotNet/new/master/apiSpec/new?filename=AiDotNet_RetrievalAugmentedGeneration_QueryExpansion_MultiQueryExpansion.md&amp;value=---%0Auid%3A%20AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.MultiQueryExpansion%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="AiDotNet">
            AiDotNet
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.MultiQueryExpansion">



  <h1 id="AiDotNet_RetrievalAugmentedGeneration_QueryExpansion_MultiQueryExpansion" data-uid="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.MultiQueryExpansion" class="text-break">
Class MultiQueryExpansion  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/RetrievalAugmentedGeneration/QueryExpansion/MultiQueryExpansion.cs/#L57"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="AiDotNet.html">AiDotNet</a>.<a class="xref" href="AiDotNet.RetrievalAugmentedGeneration.html">RetrievalAugmentedGeneration</a>.<a class="xref" href="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.html">QueryExpansion</a></dd></dl>
  <dl><dt>Assembly</dt><dd>AiDotNet.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Expands queries by generating multiple query variations from different perspectives using LLM-based reformulation.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class MultiQueryExpansion : QueryExpansionBase</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><a class="xref" href="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.QueryExpansionBase.html">QueryExpansionBase</a></div>
      <div><span class="xref">MultiQueryExpansion</span></div>
    </dd>
  </dl>



  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>




  <h2 id="AiDotNet_RetrievalAugmentedGeneration_QueryExpansion_MultiQueryExpansion_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p>
MultiQueryExpansion addresses the vocabulary mismatch problem in retrieval by creating diverse phrasings of the same
information need. Instead of searching with a single query, it generates 3-5 reformulations (questions, statements,
contextual phrases, synonyms) and retrieves documents for each variation, then merges and deduplicates results.
This approach significantly improves recall by capturing documents that use different terminology than the original
query. The implementation uses pattern-based transformations as a fallback but is designed to integrate with LLMs
for more sophisticated reformulations (e.g., technical → layman, abstract → concrete, general → specific perspectives).
</p>
<p><b>For Beginners:</b> Think of this like asking the same question in different ways:
<p>Regular search: &quot;machine learning algorithms&quot;</p>
<p>Multi-query expansion generates:</p>
<ol>
<li>&quot;What are machine learning algorithms?&quot; (question form)</li>
<li>&quot;information about machine learning algorithms&quot; (contextual)</li>
<li>&quot;artificial intelligence techniques&quot; (synonym expansion)</li>
<li>&quot;ML algorithms&quot; (simplified)</li>
<li>&quot;machine learning methods&quot; (variation)</li>
</ol>
<p>Then searches using ALL variations and combines results!</p>
<pre><code class="lang-csharp">var expander = new MultiQueryExpansion(
    llmEndpoint: &quot;http://localhost:1234/v1&quot;,
    llmApiKey: &quot;your-key&quot;,
    numVariations: 5
);

var queries = expander.ExpandQuery(&quot;deep learning optimization&quot;);
// Returns: [&quot;deep learning optimization&quot;, &quot;What is deep learning optimization?&quot;, 
//           &quot;details about deep learning optimization&quot;, &quot;neural network training&quot;, ...]
</code></pre>
<p>Why use MultiQueryExpansion:</p>
<ul>
<li>Finds documents using different terminology (e.g., &quot;car&quot; vs &quot;automobile&quot;)</li>
<li>Improves recall without sacrificing precision</li>
<li>Handles ambiguous queries (explores multiple interpretations)</li>
<li>Effective for cross-domain search (technical ↔ layman terms)</li>
</ul>
<p>When NOT to use it:</p>
<ul>
<li>Very specific queries with clear terminology (wastes compute)</li>
<li>High-latency systems (multiplies retrieval cost by numVariations)</li>
<li>When you need ONLY exact matches</li>
<li>Extremely short queries (no room for variation)</li>
</ul>

</div>


  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="AiDotNet_RetrievalAugmentedGeneration_QueryExpansion_MultiQueryExpansion__ctor_" data-uid="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.MultiQueryExpansion.#ctor*"></a>

  <h3 id="AiDotNet_RetrievalAugmentedGeneration_QueryExpansion_MultiQueryExpansion__ctor_System_String_System_String_System_Int32_" data-uid="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.MultiQueryExpansion.#ctor(System.String,System.String,System.Int32)">
  MultiQueryExpansion(string, string, int)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/RetrievalAugmentedGeneration/QueryExpansion/MultiQueryExpansion.cs/#L74"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Initializes a new instance of the <a class="xref" href="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.MultiQueryExpansion.html">MultiQueryExpansion</a> class.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public MultiQueryExpansion(string llmEndpoint, string llmApiKey, int numVariations)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>llmEndpoint</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The LLM API endpoint.</p>
</dd>
    <dt><code>llmApiKey</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The API key for the LLM service.</p>
</dd>
    <dt><code>numVariations</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>Number of query variations to generate.</p>
</dd>
  </dl>












  <h2 class="section" id="methods">Methods
</h2>


  <a id="AiDotNet_RetrievalAugmentedGeneration_QueryExpansion_MultiQueryExpansion_ExpandQuery_" data-uid="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.MultiQueryExpansion.ExpandQuery*"></a>

  <h3 id="AiDotNet_RetrievalAugmentedGeneration_QueryExpansion_MultiQueryExpansion_ExpandQuery_System_String_" data-uid="AiDotNet.RetrievalAugmentedGeneration.QueryExpansion.MultiQueryExpansion.ExpandQuery(System.String)">
  ExpandQuery(string)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/RetrievalAugmentedGeneration/QueryExpansion/MultiQueryExpansion.cs/#L89"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Expands a query into multiple variations.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public override List&lt;string&gt; ExpandQuery(string query)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>query</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The original query.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.list-1">List</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>&gt;</dt>
    <dd><p>A list of expanded queries.</p>
</dd>
  </dl>












</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ooples/AiDotNet/blob/master/src/RetrievalAugmentedGeneration/QueryExpansion/MultiQueryExpansion.cs/#L57" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          AiDotNet - Enterprise AI/ML Library for .NET
        </div>
      </div>
    </footer>
  </body>
</html>
