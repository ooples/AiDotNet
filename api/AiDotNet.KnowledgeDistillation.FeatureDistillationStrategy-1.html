<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class FeatureDistillationStrategy&lt;T&gt; | AiDotNet Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class FeatureDistillationStrategy&lt;T&gt; | AiDotNet Documentation ">
      
      <meta name="description" content="Implements feature-based knowledge distillation (FitNets) where the student learns to match the teacher&#39;s intermediate layer representations.">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ooples/AiDotNet/new/master/apiSpec/new?filename=AiDotNet_KnowledgeDistillation_FeatureDistillationStrategy_1.md&amp;value=---%0Auid%3A%20AiDotNet.KnowledgeDistillation.FeatureDistillationStrategy%601%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="AiDotNet">
            AiDotNet
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="AiDotNet.KnowledgeDistillation.FeatureDistillationStrategy`1">



  <h1 id="AiDotNet_KnowledgeDistillation_FeatureDistillationStrategy_1" data-uid="AiDotNet.KnowledgeDistillation.FeatureDistillationStrategy`1" class="text-break">
Class FeatureDistillationStrategy&lt;T&gt;  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/KnowledgeDistillation/FeatureDistillationStrategy.cs/#L42"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="AiDotNet.html">AiDotNet</a>.<a class="xref" href="AiDotNet.KnowledgeDistillation.html">KnowledgeDistillation</a></dd></dl>
  <dl><dt>Assembly</dt><dd>AiDotNet.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Implements feature-based knowledge distillation (FitNets) where the student learns to match
the teacher's intermediate layer representations.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class FeatureDistillationStrategy&lt;T&gt;</code></pre>
  </div>



  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type for calculations (e.g., double, float).</p>
</dd>
  </dl>

  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">FeatureDistillationStrategy&lt;T&gt;</span></div>
    </dd>
  </dl>



  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>




  <h2 id="AiDotNet_KnowledgeDistillation_FeatureDistillationStrategy_1_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p><b>For Beginners:</b> While standard distillation transfers knowledge through final outputs,
feature distillation goes deeper by matching intermediate layer activations. This helps the student
learn not just what the teacher predicts, but how it thinks.</p>
<p><b>Why Feature Distillation?</b>
- **Better for Different Architectures**: When student and teacher have very different structures
- **Richer Knowledge Transfer**: Captures hierarchical feature learning
- **Improved Generalization**: Student learns more robust representations
- **Complementary to Response Distillation**: Can be combined with standard distillation</p>
<p><b>Real-world Analogy:</b>
Imagine learning to paint from a master artist. Standard distillation is like copying only the
final painting. Feature distillation is like watching the master's brush strokes, color mixing,
and layering techniques - learning the process, not just the result.</p>
<p><b>How It Works:</b>
1. Extract features from a teacher layer (e.g., conv3 in ResNet)
2. Extract features from corresponding student layer
3. Minimize MSE (Mean Squared Error) between them
4. Optionally use a projection layer if dimensions don't match</p>
<p><b>Common Applications:</b>
- ResNet → MobileNet: Match convolutional feature maps
- BERT → DistilBERT: Match transformer layer outputs
- Teacher and student with different widths/depths</p>
<p><b>References:</b>
- Romero, A., et al. (2014). FitNets: Hints for Thin Deep Nets. arXiv:1412.6550</p>
</div>


  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="AiDotNet_KnowledgeDistillation_FeatureDistillationStrategy_1__ctor_" data-uid="AiDotNet.KnowledgeDistillation.FeatureDistillationStrategy`1.#ctor*"></a>

  <h3 id="AiDotNet_KnowledgeDistillation_FeatureDistillationStrategy_1__ctor_System_String___System_Double_" data-uid="AiDotNet.KnowledgeDistillation.FeatureDistillationStrategy`1.#ctor(System.String[],System.Double)">
  FeatureDistillationStrategy(string[], double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/KnowledgeDistillation/FeatureDistillationStrategy.cs/#L75"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Initializes a new instance of the FeatureDistillationStrategy class.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public FeatureDistillationStrategy(string[] layerPairs, double featureWeight = 0.5)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>layerPairs</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>[]</dt>
    <dd><p>Names of layer pairs to match (teacher_layer:student_layer format).
Example: [&quot;conv3:conv2&quot;, &quot;conv4:conv3&quot;]</p>
</dd>
    <dt><code>featureWeight</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Weight for feature loss vs. output loss (default 0.5).
Higher values emphasize matching intermediate features.</p>
</dd>
  </dl>








  <h4 class="section" id="AiDotNet_KnowledgeDistillation_FeatureDistillationStrategy_1__ctor_System_String___System_Double__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> Layer pairs specify which teacher layers should be matched
to which student layers. Format: "teacher_layer_name:student_layer_name"</p>
<p>Example usage:
<pre><code class="lang-csharp">// Match teacher's layer 3 to student's layer 2, and teacher's 4 to student's 3
var strategy = new FeatureDistillationStrategy&lt;double&gt;(
    layerPairs: new[] { "layer3:layer2", "layer4:layer3" },
    featureWeight: 0.5  // Equal weight to features and outputs
);</code></pre>

<p><b>Tips for choosing layer pairs:</b>
- Match semantically similar layers (similar depth in network)
- Start with 1-2 pairs, add more if needed
- Earlier layers: low-level features (edges, textures)
- Later layers: high-level features (objects, concepts)</p>
</div>




  <h2 class="section" id="methods">Methods
</h2>


  <a id="AiDotNet_KnowledgeDistillation_FeatureDistillationStrategy_1_ComputeFeatureGradient_" data-uid="AiDotNet.KnowledgeDistillation.FeatureDistillationStrategy`1.ComputeFeatureGradient*"></a>

  <h3 id="AiDotNet_KnowledgeDistillation_FeatureDistillationStrategy_1_ComputeFeatureGradient_AiDotNet_Tensors_LinearAlgebra_Vector__0__AiDotNet_Tensors_LinearAlgebra_Vector__0__" data-uid="AiDotNet.KnowledgeDistillation.FeatureDistillationStrategy`1.ComputeFeatureGradient(AiDotNet.Tensors.LinearAlgebra.Vector{`0},AiDotNet.Tensors.LinearAlgebra.Vector{`0})">
  ComputeFeatureGradient(Vector&lt;T&gt;, Vector&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/KnowledgeDistillation/FeatureDistillationStrategy.cs/#L220"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Computes the gradient of feature loss for backpropagation.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public Vector&lt;T&gt; ComputeFeatureGradient(Vector&lt;T&gt; studentFeatures, Vector&lt;T&gt; teacherFeatures)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>studentFeatures</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>Student's feature vector.</p>
</dd>
    <dt><code>teacherFeatures</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>Teacher's feature vector.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>Gradient vector for backpropagation.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_KnowledgeDistillation_FeatureDistillationStrategy_1_ComputeFeatureGradient_AiDotNet_Tensors_LinearAlgebra_Vector__0__AiDotNet_Tensors_LinearAlgebra_Vector__0___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> The gradient of MSE is simple:
∂MSE/∂student = (2/n) × (student - teacher)</p>
<p>This tells us: if student feature is too high, decrease it; if too low, increase it.</p>
</div>




  <a id="AiDotNet_KnowledgeDistillation_FeatureDistillationStrategy_1_ComputeFeatureLoss_" data-uid="AiDotNet.KnowledgeDistillation.FeatureDistillationStrategy`1.ComputeFeatureLoss*"></a>

  <h3 id="AiDotNet_KnowledgeDistillation_FeatureDistillationStrategy_1_ComputeFeatureLoss_System_Func_System_String_AiDotNet_Tensors_LinearAlgebra_Vector__0___System_Func_System_String_AiDotNet_Tensors_LinearAlgebra_Vector__0___AiDotNet_Tensors_LinearAlgebra_Vector__0__" data-uid="AiDotNet.KnowledgeDistillation.FeatureDistillationStrategy`1.ComputeFeatureLoss(System.Func{System.String,AiDotNet.Tensors.LinearAlgebra.Vector{`0}},System.Func{System.String,AiDotNet.Tensors.LinearAlgebra.Vector{`0}},AiDotNet.Tensors.LinearAlgebra.Vector{`0})">
  ComputeFeatureLoss(Func&lt;string, Vector&lt;T&gt;&gt;, Func&lt;string, Vector&lt;T&gt;&gt;, Vector&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/KnowledgeDistillation/FeatureDistillationStrategy.cs/#L134"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Computes the feature matching loss between student and teacher intermediate representations.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public T ComputeFeatureLoss(Func&lt;string, Vector&lt;T&gt;&gt; teacherFeatureExtractor, Func&lt;string, Vector&lt;T&gt;&gt; studentFeatureExtractor, Vector&lt;T&gt; input)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>teacherFeatureExtractor</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.func-2">Func</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>, <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;&gt;</dt>
    <dd><p>Function to extract teacher features for a layer name.</p>
</dd>
    <dt><code>studentFeatureExtractor</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.func-2">Func</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>, <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;&gt;</dt>
    <dd><p>Function to extract student features for a layer name.</p>
</dd>
    <dt><code>input</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>Input data for forward pass.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><span class="xref">T</span></dt>
    <dd><p>Mean squared error between matched feature pairs.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_KnowledgeDistillation_FeatureDistillationStrategy_1_ComputeFeatureLoss_System_Func_System_String_AiDotNet_Tensors_LinearAlgebra_Vector__0___System_Func_System_String_AiDotNet_Tensors_LinearAlgebra_Vector__0___AiDotNet_Tensors_LinearAlgebra_Vector__0___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This computes how different the student's internal features
are from the teacher's. Lower loss means the student is learning to think like the teacher.</p>
<p>The loss is computed as:
L_feature = (1/N) × Σ MSE(teacher_features_i, student_features_i)
where N is the number of layer pairs.</p>
<p>If feature dimensions don't match, consider adding a projection layer
(simple linear transformation) to the student.</p>
</div>





</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ooples/AiDotNet/blob/master/src/KnowledgeDistillation/FeatureDistillationStrategy.cs/#L42" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          AiDotNet - Enterprise AI/ML Library for .NET
        </div>
      </div>
    </footer>
  </body>
</html>
