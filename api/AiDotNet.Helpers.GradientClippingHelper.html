<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class GradientClippingHelper | AiDotNet Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class GradientClippingHelper | AiDotNet Documentation ">
      
      <meta name="description" content="Provides gradient clipping utilities to prevent exploding gradients during training.">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ooples/AiDotNet/new/master/apiSpec/new?filename=AiDotNet_Helpers_GradientClippingHelper.md&amp;value=---%0Auid%3A%20AiDotNet.Helpers.GradientClippingHelper%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="AiDotNet">
            AiDotNet
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="AiDotNet.Helpers.GradientClippingHelper">



  <h1 id="AiDotNet_Helpers_GradientClippingHelper" data-uid="AiDotNet.Helpers.GradientClippingHelper" class="text-break">
Class GradientClippingHelper  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L19"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="AiDotNet.html">AiDotNet</a>.<a class="xref" href="AiDotNet.Helpers.html">Helpers</a></dd></dl>
  <dl><dt>Assembly</dt><dd>AiDotNet.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Provides gradient clipping utilities to prevent exploding gradients during training.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static class GradientClippingHelper</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">GradientClippingHelper</span></div>
    </dd>
  </dl>



  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>




  <h2 id="AiDotNet_Helpers_GradientClippingHelper_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p><b>For Beginners:</b> During neural network training, gradients tell us how to adjust
weights. Sometimes gradients become extremely large ("exploding gradients"), which can
destabilize training. Gradient clipping limits the magnitude of gradients to keep
training stable.
<p>There are two main approaches:</p>
<ul>
<li><strong>Clip by Value</strong>: Limits each gradient element to a range (e.g., -1 to 1)</li>
<li><strong>Clip by Norm</strong>: Scales the entire gradient vector if its norm exceeds a threshold</li>
</ul>
<p>The &quot;by norm&quot; approach is generally preferred as it preserves gradient direction.</p>

</div>


  <h2 class="section" id="fields">Fields
</h2>



  <h3 id="AiDotNet_Helpers_GradientClippingHelper_DefaultMaxNorm" data-uid="AiDotNet.Helpers.GradientClippingHelper.DefaultMaxNorm">
  DefaultMaxNorm
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L24"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Default maximum gradient norm for clipping.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public const double DefaultMaxNorm = 1</code></pre>
  </div>




  <h4 class="section">Field Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd></dd>
  </dl>










  <h3 id="AiDotNet_Helpers_GradientClippingHelper_DefaultMaxValue" data-uid="AiDotNet.Helpers.GradientClippingHelper.DefaultMaxValue">
  DefaultMaxValue
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L29"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Default maximum gradient value for value clipping.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public const double DefaultMaxValue = 1</code></pre>
  </div>




  <h4 class="section">Field Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd></dd>
  </dl>









  <h2 class="section" id="methods">Methods
</h2>


  <a id="AiDotNet_Helpers_GradientClippingHelper_AreGradientsExploding_" data-uid="AiDotNet.Helpers.GradientClippingHelper.AreGradientsExploding*"></a>

  <h3 id="AiDotNet_Helpers_GradientClippingHelper_AreGradientsExploding__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__System_Double_" data-uid="AiDotNet.Helpers.GradientClippingHelper.AreGradientsExploding``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0},System.Double)">
  AreGradientsExploding&lt;T&gt;(Vector&lt;T&gt;, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L385"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Detects if gradients are exploding (have very large values).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool AreGradientsExploding&lt;T&gt;(Vector&lt;T&gt; gradients, double threshold = 1000000)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>gradients</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The gradient vector to check.</p>
</dd>
    <dt><code>threshold</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Threshold for considering gradients as exploding.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if gradients appear to be exploding.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_GradientClippingHelper_AreGradientsVanishing_" data-uid="AiDotNet.Helpers.GradientClippingHelper.AreGradientsVanishing*"></a>

  <h3 id="AiDotNet_Helpers_GradientClippingHelper_AreGradientsVanishing__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__System_Double_" data-uid="AiDotNet.Helpers.GradientClippingHelper.AreGradientsVanishing``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0},System.Double)">
  AreGradientsVanishing&lt;T&gt;(Vector&lt;T&gt;, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L404"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Detects if gradients are vanishing (have very small values).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool AreGradientsVanishing&lt;T&gt;(Vector&lt;T&gt; gradients, double threshold = 1E-07)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>gradients</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The gradient vector to check.</p>
</dd>
    <dt><code>threshold</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Threshold for considering gradients as vanishing.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if gradients appear to be vanishing.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_GradientClippingHelper_ClipAdaptive_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ClipAdaptive*"></a>

  <h3 id="AiDotNet_Helpers_GradientClippingHelper_ClipAdaptive__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__AiDotNet_Tensors_LinearAlgebra_Vector___0__System_Double_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ClipAdaptive``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0},AiDotNet.Tensors.LinearAlgebra.Vector{``0},System.Double)">
  ClipAdaptive&lt;T&gt;(Vector&lt;T&gt;?, Vector&lt;T&gt;?, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L341"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Applies adaptive gradient clipping based on parameter norm.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static Vector&lt;T&gt;? ClipAdaptive&lt;T&gt;(Vector&lt;T&gt;? gradients, Vector&lt;T&gt;? parameters, double clipRatio = 0.01)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>gradients</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The gradient vector.</p>
</dd>
    <dt><code>parameters</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The corresponding parameter vector.</p>
</dd>
    <dt><code>clipRatio</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Ratio threshold for clipping (e.g., 0.01 means gradient norm should not exceed 1% of parameter norm).</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>Clipped gradients.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>






  <h4 class="section" id="AiDotNet_Helpers_GradientClippingHelper_ClipAdaptive__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__AiDotNet_Tensors_LinearAlgebra_Vector___0__System_Double__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> Adaptive gradient clipping (AGC) scales the clipping threshold
based on the magnitude of the parameters themselves. This is useful because large parameters
can tolerate larger gradients without destabilizing, while small parameters need tighter
gradient bounds.
<p>This technique was introduced in the NFNet paper and can help train very deep networks
without batch normalization.</p>

</div>




  <a id="AiDotNet_Helpers_GradientClippingHelper_ClipByGlobalNorm_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ClipByGlobalNorm*"></a>

  <h3 id="AiDotNet_Helpers_GradientClippingHelper_ClipByGlobalNorm__1_System_Collections_Generic_List_AiDotNet_Tensors_LinearAlgebra_Vector___0___System_Double_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ClipByGlobalNorm``1(System.Collections.Generic.List{AiDotNet.Tensors.LinearAlgebra.Vector{``0}},System.Double)">
  ClipByGlobalNorm&lt;T&gt;(List&lt;Vector&lt;T&gt;&gt;?, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L184"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Clips gradients by global norm across multiple gradient vectors.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static List&lt;Vector&lt;T&gt;&gt;? ClipByGlobalNorm&lt;T&gt;(List&lt;Vector&lt;T&gt;&gt;? gradientsList, double maxNorm = 1)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>gradientsList</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.list-1">List</a>&lt;<a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;&gt;</dt>
    <dd><p>List of gradient vectors to clip together.</p>
</dd>
    <dt><code>maxNorm</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Maximum global L2 norm.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.list-1">List</a>&lt;<a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;&gt;</dt>
    <dd><p>A list of clipped gradient vectors.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>






  <h4 class="section" id="AiDotNet_Helpers_GradientClippingHelper_ClipByGlobalNorm__1_System_Collections_Generic_List_AiDotNet_Tensors_LinearAlgebra_Vector___0___System_Double__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> When training a neural network with multiple layers,
each layer has its own gradients. Global norm clipping computes the norm across
ALL gradients and scales them all together. This ensures consistent clipping
behavior across the entire network.
</p>
</div>




  <a id="AiDotNet_Helpers_GradientClippingHelper_ClipByNormInPlace_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ClipByNormInPlace*"></a>

  <h3 id="AiDotNet_Helpers_GradientClippingHelper_ClipByNormInPlace__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__System_Double_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ClipByNormInPlace``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0},System.Double)">
  ClipByNormInPlace&lt;T&gt;(Vector&lt;T&gt;, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L139"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Clips gradients by their L2 norm in place.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static bool ClipByNormInPlace&lt;T&gt;(Vector&lt;T&gt; gradients, double maxNorm = 1)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>gradients</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The gradient vector to clip (modified in place).</p>
</dd>
    <dt><code>maxNorm</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Maximum L2 norm for the gradient vector.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if clipping was applied, false otherwise.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_GradientClippingHelper_ClipByNorm_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ClipByNorm*"></a>

  <h3 id="AiDotNet_Helpers_GradientClippingHelper_ClipByNorm__1_AiDotNet_Tensors_LinearAlgebra_Tensor___0__System_Double_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ClipByNorm``1(AiDotNet.Tensors.LinearAlgebra.Tensor{``0},System.Double)">
  ClipByNorm&lt;T&gt;(Tensor&lt;T&gt;?, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L239"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Clips tensor gradients by their L2 norm.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static Tensor&lt;T&gt;? ClipByNorm&lt;T&gt;(Tensor&lt;T&gt;? gradients, double maxNorm = 1)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>gradients</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>The gradient tensor to clip.</p>
</dd>
    <dt><code>maxNorm</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Maximum L2 norm.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Tensor-1.html">Tensor</a>&lt;T&gt;</dt>
    <dd><p>A new tensor with clipped gradients.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_GradientClippingHelper_ClipByNorm_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ClipByNorm*"></a>

  <h3 id="AiDotNet_Helpers_GradientClippingHelper_ClipByNorm__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__System_Double_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ClipByNorm``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0},System.Double)">
  ClipByNorm&lt;T&gt;(Vector&lt;T&gt;?, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L100"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Clips gradients by their L2 norm (global norm clipping).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static Vector&lt;T&gt;? ClipByNorm&lt;T&gt;(Vector&lt;T&gt;? gradients, double maxNorm = 1)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>gradients</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The gradient vector to clip.</p>
</dd>
    <dt><code>maxNorm</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Maximum L2 norm for the gradient vector.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>A new vector with clipped gradients.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>






  <h4 class="section" id="AiDotNet_Helpers_GradientClippingHelper_ClipByNorm__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__System_Double__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This is the preferred gradient clipping method.
Instead of clipping each value independently, we look at the total "length"
(norm) of the gradient vector. If it exceeds maxNorm, we scale the entire
vector down proportionally.
<p>This preserves the direction of the gradient while limiting its magnitude,
which typically leads to better training behavior.</p>
<p>Formula: if ||g|| &gt; maxNorm, then g = g * (maxNorm / ||g||)</p>

</div>




  <a id="AiDotNet_Helpers_GradientClippingHelper_ClipByValueInPlace_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ClipByValueInPlace*"></a>

  <h3 id="AiDotNet_Helpers_GradientClippingHelper_ClipByValueInPlace__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__System_Double_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ClipByValueInPlace``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0},System.Double)">
  ClipByValueInPlace&lt;T&gt;(Vector&lt;T&gt;, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L67"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Clips gradient values to a specified range [-maxValue, maxValue] in place.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static void ClipByValueInPlace&lt;T&gt;(Vector&lt;T&gt; gradients, double maxValue = 1)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>gradients</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The gradient vector to clip (modified in place).</p>
</dd>
    <dt><code>maxValue</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Maximum absolute value for any gradient element.</p>
</dd>
  </dl>


  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_GradientClippingHelper_ClipByValue_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ClipByValue*"></a>

  <h3 id="AiDotNet_Helpers_GradientClippingHelper_ClipByValue__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__System_Double_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ClipByValue``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0},System.Double)">
  ClipByValue&lt;T&gt;(Vector&lt;T&gt;?, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L44"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Clips gradient values to a specified range [-maxValue, maxValue].</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static Vector&lt;T&gt;? ClipByValue&lt;T&gt;(Vector&lt;T&gt;? gradients, double maxValue = 1)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>gradients</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The gradient vector to clip.</p>
</dd>
    <dt><code>maxValue</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>Maximum absolute value for any gradient element.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>A new vector with clipped gradients.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>






  <h4 class="section" id="AiDotNet_Helpers_GradientClippingHelper_ClipByValue__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__System_Double__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This is the simplest form of gradient clipping.
Each gradient value is independently limited to the range [-maxValue, maxValue].
For example, with maxValue=1.0, a gradient of 5.0 becomes 1.0, and -3.0 becomes -1.0.
</p>
</div>




  <a id="AiDotNet_Helpers_GradientClippingHelper_ComputeGlobalNorm_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ComputeGlobalNorm*"></a>

  <h3 id="AiDotNet_Helpers_GradientClippingHelper_ComputeGlobalNorm__1_System_Collections_Generic_List_AiDotNet_Tensors_LinearAlgebra_Vector___0___" data-uid="AiDotNet.Helpers.GradientClippingHelper.ComputeGlobalNorm``1(System.Collections.Generic.List{AiDotNet.Tensors.LinearAlgebra.Vector{``0}})">
  ComputeGlobalNorm&lt;T&gt;(List&lt;Vector&lt;T&gt;&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L302"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Computes the global L2 norm across multiple gradient vectors.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static T ComputeGlobalNorm&lt;T&gt;(List&lt;Vector&lt;T&gt;&gt; gradientsList)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>gradientsList</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.list-1">List</a>&lt;<a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;&gt;</dt>
    <dd><p>List of gradient vectors.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><span class="xref">T</span></dt>
    <dd><p>The global L2 norm.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>










  <a id="AiDotNet_Helpers_GradientClippingHelper_ComputeNorm_" data-uid="AiDotNet.Helpers.GradientClippingHelper.ComputeNorm*"></a>

  <h3 id="AiDotNet_Helpers_GradientClippingHelper_ComputeNorm__1_AiDotNet_Tensors_LinearAlgebra_Vector___0__" data-uid="AiDotNet.Helpers.GradientClippingHelper.ComputeNorm``1(AiDotNet.Tensors.LinearAlgebra.Vector{``0})">
  ComputeNorm&lt;T&gt;(Vector&lt;T&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L279"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Computes the L2 norm of a gradient vector.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static T ComputeNorm&lt;T&gt;(Vector&lt;T&gt; gradients)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>gradients</code> <a class="xref" href="AiDotNet.Tensors.LinearAlgebra.Vector-1.html">Vector</a>&lt;T&gt;</dt>
    <dd><p>The gradient vector.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><span class="xref">T</span></dt>
    <dd><p>The L2 norm.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type.</p>
</dd>
  </dl>











</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ooples/AiDotNet/blob/master/src/Helpers/GradientClippingHelper.cs/#L19" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          AiDotNet - Enterprise AI/ML Library for .NET
        </div>
      </div>
    </footer>
  </body>
</html>
