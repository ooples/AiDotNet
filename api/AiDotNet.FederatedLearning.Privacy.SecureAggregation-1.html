<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class SecureAggregation&lt;T&gt; | AiDotNet Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class SecureAggregation&lt;T&gt; | AiDotNet Documentation ">
      
      <meta name="description" content="Implements secure aggregation for federated learning using cryptographic techniques.">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ooples/AiDotNet/new/master/apiSpec/new?filename=AiDotNet_FederatedLearning_Privacy_SecureAggregation_1.md&amp;value=---%0Auid%3A%20AiDotNet.FederatedLearning.Privacy.SecureAggregation%601%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="AiDotNet">
            AiDotNet
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1">



  <h1 id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1" class="text-break">
Class SecureAggregation&lt;T&gt;  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/FederatedLearning/Privacy/SecureAggregation.cs/#L74"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="AiDotNet.html">AiDotNet</a>.<a class="xref" href="AiDotNet.FederatedLearning.html">FederatedLearning</a>.<a class="xref" href="AiDotNet.FederatedLearning.Privacy.html">Privacy</a></dd></dl>
  <dl><dt>Assembly</dt><dd>AiDotNet.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Implements secure aggregation for federated learning using cryptographic techniques.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class SecureAggregation&lt;T&gt; : FederatedLearningComponentBase&lt;T&gt;, IDisposable</code></pre>
  </div>



  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The numeric type for model parameters (e.g., double, float).</p>
</dd>
  </dl>

  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><a class="xref" href="AiDotNet.FederatedLearning.Infrastructure.FederatedLearningComponentBase-1.html">FederatedLearningComponentBase</a>&lt;T&gt;</div>
      <div><span class="xref">SecureAggregation&lt;T&gt;</span></div>
    </dd>
  </dl>

  <dl class="typelist implements">
    <dt>Implements</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.idisposable">IDisposable</a></div>
    </dd>
  </dl>


  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="AiDotNet.FederatedLearning.Infrastructure.FederatedLearningComponentBase-1.html#AiDotNet_FederatedLearning_Infrastructure_FederatedLearningComponentBase_1_NumOps">FederatedLearningComponentBase&lt;T&gt;.NumOps</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>




  <h2 id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p>Secure aggregation is a cryptographic protocol that allows a server to compute the sum
of client updates without seeing individual contributions. Only the final aggregate is
visible to the server.</p>
<p><b>For Beginners:</b> Secure aggregation is like a secret ballot election where votes
are counted but individual votes remain private.</p>
<p>How it works (simplified):</p>
<ol>
<li>Each client generates pairwise secret keys with other clients</li>
<li>Clients mask their model updates with these secret keys</li>
<li>Server receives masked updates: masked_update_i = update_i + Σ(secrets_ij)</li>
<li>Secret masks cancel out when summing: Σ(masked_update_i) = Σ(update_i)</li>
<li>Server gets the sum without seeing individual updates</li>
</ol>
<p>Example with 3 clients:</p>
<ul>
<li>Client 1 shares secrets: s₁₂ with Client 2, s₁₃ with Client 3</li>
<li>Client 2 shares secrets: s₂₁ with Client 1, s₂₃ with Client 3</li>
<li>Client 3 shares secrets: s₃₁ with Client 1, s₃₂ with Client 2</li>
</ul>
<p>Note: s₁₂ = -s₂₁ (secrets cancel in pairs)</p>
<p>Client 1 sends: update₁ + s₁₂ + s₁₃
Client 2 sends: update₂ + s₂₁ + s₂₃
Client 3 sends: update₃ + s₃₁ + s₃₂</p>
<p>Server computes sum:
(update₁ + s₁₂ + s₁₃) + (update₂ + s₂₁ + s₂₃) + (update₃ + s₃₁ + s₃₂)
= update₁ + update₂ + update₃ + (s₁₂ + s₂₁) + (s₁₃ + s₃₁) + (s₂₃ + s₃₂)
= update₁ + update₂ + update₃ + 0 + 0 + 0
= Σ(updates) ← Only this is visible to server!</p>
<p>This implementation derives pairwise mask seeds from per-round ephemeral ECDH shared secrets and expands them
via HKDF + a deterministic PRG. Pairwise masks cancel in the aggregate as long as all selected clients participate
in the round (synchronous, full-participation mode).</p>
<p>Benefits:</p>
<ul>
<li>Server cannot see individual client updates</li>
<li>Protects against honest-but-curious server</li>
<li>No trusted third party needed</li>
<li>Computation overhead is reasonable</li>
</ul>
<p>Limitations:</p>
<ul>
<li>Requires coordination between clients</li>
<li>All (or threshold) clients must participate for masks to cancel</li>
<li>Dropout handling requires additional mechanisms</li>
<li>Communication overhead for key exchange</li>
</ul>
<p>When to use Secure Aggregation:</p>
<ul>
<li>Don't fully trust the central server</li>
<li>Regulatory requirements for data protection</li>
<li>Want cryptographic privacy guarantees</li>
<li>Willing to handle additional complexity</li>
</ul>
<p>Can be combined with differential privacy for stronger protection:</p>
<ul>
<li>Secure aggregation: Protects individual updates from server</li>
<li>Differential privacy: Protects individual data points from anyone</li>
</ul>
<p>Reference: Bonawitz, K., et al. (2017). &quot;Practical Secure Aggregation for Privacy-Preserving
Machine Learning.&quot; CCS 2017.</p>
</div>


  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1__ctor_" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.#ctor*"></a>

  <h3 id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1__ctor_System_Int32_System_Nullable_System_Int32__" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.#ctor(System.Int32,System.Nullable{System.Int32})">
  SecureAggregation(int, int?)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/FederatedLearning/Privacy/SecureAggregation.cs/#L98"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Initializes a new instance of the <a class="xref" href="AiDotNet.FederatedLearning.Privacy.SecureAggregation-1.html">SecureAggregation&lt;T&gt;</a> class.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public SecureAggregation(int parameterCount, int? randomSeed = null)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>parameterCount</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The total number of model parameters to protect.</p>
</dd>
    <dt><code>randomSeed</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a>?</dt>
    <dd><p>Optional random seed for reproducibility.</p>
</dd>
  </dl>








  <h4 class="section" id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1__ctor_System_Int32_System_Nullable_System_Int32___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> Sets up the secure aggregation protocol for a specific
number of model parameters.</p>
<p>In practice, this would involve:</p>
<ul>
<li>Secure key exchange between clients</li>
<li>Authenticated channels</li>
<li>Agreement on random seed for deterministic mask generation</li>
</ul>
<p>In this in-memory implementation, pairwise masks are generated per-round and must be re-generated for each round.</p>
</div>




  <h2 class="section" id="methods">Methods
</h2>


  <a id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_AggregateSecurely_" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.AggregateSecurely*"></a>

  <h3 id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_AggregateSecurely_System_Collections_Generic_Dictionary_System_Int32_System_Collections_Generic_Dictionary_System_String__0_____System_Collections_Generic_Dictionary_System_Int32_System_Double__" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.AggregateSecurely(System.Collections.Generic.Dictionary{System.Int32,System.Collections.Generic.Dictionary{System.String,`0[]}},System.Collections.Generic.Dictionary{System.Int32,System.Double})">
  AggregateSecurely(Dictionary&lt;int, Dictionary&lt;string, T[]&gt;&gt;, Dictionary&lt;int, double&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/FederatedLearning/Privacy/SecureAggregation.cs/#L339"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Aggregates masked updates from all clients, returning a weighted average.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public Dictionary&lt;string, T[]&gt; AggregateSecurely(Dictionary&lt;int, Dictionary&lt;string, T[]&gt;&gt; maskedUpdates, Dictionary&lt;int, double&gt; clientWeights)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>maskedUpdates</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.dictionary-2">Dictionary</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.dictionary-2">Dictionary</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>, T[]&gt;&gt;</dt>
    <dd><p>Dictionary of client IDs to their masked updates.</p>
</dd>
    <dt><code>clientWeights</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.dictionary-2">Dictionary</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a>&gt;</dt>
    <dd><p>Dictionary of client IDs to their aggregation weights.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.dictionary-2">Dictionary</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>, T[]&gt;</dt>
    <dd><p>The securely aggregated model (weighted average if clients pre-weighted their updates before masking).</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_AggregateSecurely_System_Collections_Generic_Dictionary_System_Int32_System_Collections_Generic_Dictionary_System_String__0_____System_Collections_Generic_Dictionary_System_Int32_System_Double___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This sums up all the masked updates. Because the secret
masks cancel out, the server recovers the sum of the underlying (possibly weighted)
client updates without ever seeing any individual update.</p>
<p>To compute a <i>weighted average</i> securely:</p>
<ul>
<li>Each client must apply its weight to its update <i>before</i> masking (use <a class="xref" href="AiDotNet.FederatedLearning.Privacy.SecureAggregation-1.html#AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_MaskUpdate_System_Int32_System_Collections_Generic_Dictionary_System_String__0____System_Double_">MaskUpdate(int, Dictionary&lt;string, T[]&gt;, double)</a>).</li>
<li>The server then divides the summed masked updates by the total weight.</li>
</ul>
<p>If you need the raw (un-normalized) sum of updates, use <a class="xref" href="AiDotNet.FederatedLearning.Privacy.SecureAggregation-1.html#AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_AggregateSumSecurely_System_Collections_Generic_Dictionary_System_Int32_System_Collections_Generic_Dictionary_System_String__0_____">AggregateSumSecurely(Dictionary&lt;int, Dictionary&lt;string, T[]&gt;&gt;)</a>.</p>
<p>Mathematical property:
Σ(masked_update_i) = Σ(update_i + secrets_i)
= Σ(update_i) + Σ(secrets_i)
= Σ(update_i) + 0  ← secrets cancel
= True sum of updates</p>
<p>The server performs this aggregation without ever seeing individual updates!</p>
<p>For example with 2 clients:
Client 1 masked: [0.4, 0.0, 0.85] = [0.5, -0.3, 0.8] + [-0.1, 0.3, 0.05]
Client 2 masked: [0.7, 0.1, 1.05] = [0.6, 0.4, 1.1] + [0.1, -0.3, -0.05]</p>
<p>Sum of masked: [1.1, 0.1, 1.9]
True sum: [0.5, -0.3, 0.8] + [0.6, 0.4, 1.1] = [1.1, 0.1, 1.9] ← Matches!
(Note: Secrets [-0.1, 0.3, 0.05] + [0.1, -0.3, -0.05] = [0, 0, 0] ← Cancelled)</p>
</div>




  <a id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_AggregateSumSecurely_" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.AggregateSumSecurely*"></a>

  <h3 id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_AggregateSumSecurely_System_Collections_Generic_Dictionary_System_Int32_System_Collections_Generic_Dictionary_System_String__0_____" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.AggregateSumSecurely(System.Collections.Generic.Dictionary{System.Int32,System.Collections.Generic.Dictionary{System.String,`0[]}})">
  AggregateSumSecurely(Dictionary&lt;int, Dictionary&lt;string, T[]&gt;&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/FederatedLearning/Privacy/SecureAggregation.cs/#L392"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Aggregates masked updates from all clients, returning the raw sum with masks cancelled.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public Dictionary&lt;string, T[]&gt; AggregateSumSecurely(Dictionary&lt;int, Dictionary&lt;string, T[]&gt;&gt; maskedUpdates)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>maskedUpdates</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.dictionary-2">Dictionary</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.dictionary-2">Dictionary</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>, T[]&gt;&gt;</dt>
    <dd><p>Dictionary of client IDs to their masked updates.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.dictionary-2">Dictionary</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>, T[]&gt;</dt>
    <dd><p>The securely aggregated model (sum of underlying updates with masks cancelled).</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_AggregateSumSecurely_System_Collections_Generic_Dictionary_System_Int32_System_Collections_Generic_Dictionary_System_String__0______remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>This method does not divide by any weight. It returns the sum of the underlying updates
after the pairwise masks cancel out.</p>
</div>




  <a id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_ClearSecrets_" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.ClearSecrets*"></a>

  <h3 id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_ClearSecrets" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.ClearSecrets">
  ClearSecrets()
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/FederatedLearning/Privacy/SecureAggregation.cs/#L566"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Clears all stored pairwise secrets.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void ClearSecrets()</code></pre>
  </div>









  <h4 class="section" id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_ClearSecrets_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> Removes all secret keys from memory. Should be called
after aggregation is complete for security.</p>
<p>Security best practice:</p>
<ul>
<li>Generate fresh secrets for each round</li>
<li>Clear old secrets to prevent reuse</li>
<li>Minimize time secrets are stored in memory</li>
</ul>
</div>




  <a id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_Dispose_" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.Dispose*"></a>

  <h3 id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_Dispose" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.Dispose">
  Dispose()
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/FederatedLearning/Privacy/SecureAggregation.cs/#L115"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Performs application-defined tasks associated with freeing, releasing, or resetting unmanaged resources.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void Dispose()</code></pre>
  </div>













  <a id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_Finalize_" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.Finalize*"></a>

  <h3 id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_Finalize" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.Finalize">
  ~SecureAggregation()
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/FederatedLearning/Privacy/SecureAggregation.cs/#L110"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"></div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">protected ~SecureAggregation()</code></pre>
  </div>













  <a id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_GeneratePairwiseSecrets_" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.GeneratePairwiseSecrets*"></a>

  <h3 id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_GeneratePairwiseSecrets_System_Collections_Generic_List_System_Int32__" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.GeneratePairwiseSecrets(System.Collections.Generic.List{System.Int32})">
  GeneratePairwiseSecrets(List&lt;int&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/FederatedLearning/Privacy/SecureAggregation.cs/#L162"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Generates pairwise secrets between all clients.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void GeneratePairwiseSecrets(List&lt;int&gt; clientIds)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>clientIds</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.list-1">List</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a>&gt;</dt>
    <dd><p>List of all participating client IDs.</p>
</dd>
  </dl>








  <h4 class="section" id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_GeneratePairwiseSecrets_System_Collections_Generic_List_System_Int32___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This creates secret keys that clients will use to mask
their updates. The secrets are designed so they cancel out when aggregated.</p>
<p>For each pair of clients (i, j):</p>
<ul>
<li>Generate random secret s_ij</li>
<li>Set s_ji = -s_ij (so they cancel: s_ij + s_ji = 0)</li>
</ul>
<p>In production, this would use:</p>
<ul>
<li>Diffie-Hellman key exchange</li>
<li>Public key infrastructure</li>
<li>Secure random number generation</li>
</ul>
</div>




  <a id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_GetClientCount_" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.GetClientCount*"></a>

  <h3 id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_GetClientCount" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.GetClientCount">
  GetClientCount()
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/FederatedLearning/Privacy/SecureAggregation.cs/#L577"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets the number of clients with stored secrets.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public int GetClientCount()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The count of clients.</p>
</dd>
  </dl>











  <a id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_MaskUpdate_" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.MaskUpdate*"></a>

  <h3 id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_MaskUpdate_System_Int32_System_Collections_Generic_Dictionary_System_String__0____" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.MaskUpdate(System.Int32,System.Collections.Generic.Dictionary{System.String,`0[]})">
  MaskUpdate(int, Dictionary&lt;string, T[]&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/FederatedLearning/Privacy/SecureAggregation.cs/#L216"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Masks a client's model update with pairwise secrets.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public Dictionary&lt;string, T[]&gt; MaskUpdate(int clientId, Dictionary&lt;string, T[]&gt; clientUpdate)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>clientId</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The ID of the client whose update to mask.</p>
</dd>
    <dt><code>clientUpdate</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.dictionary-2">Dictionary</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>, T[]&gt;</dt>
    <dd><p>The client's model update.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.dictionary-2">Dictionary</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>, T[]&gt;</dt>
    <dd><p>The masked model update.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_MaskUpdate_System_Int32_System_Collections_Generic_Dictionary_System_String__0_____remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p><b>For Beginners:</b> This adds secret masks to the client's update so the
server can't see the original values. Only after aggregating all clients
do the masks cancel out.</p>
<p>Mathematical operation:
masked_update = original_update + Σ(secrets_with_other_clients)</p>
<p>For example, Client 1 with 3 clients total:</p>
<ul>
<li>Original update: [0.5, -0.3, 0.8]</li>
<li>Secret with Client 2: [0.1, 0.2, -0.1]</li>
<li>Secret with Client 3: [-0.2, 0.1, 0.15]</li>
<li>Masked update: [0.4, 0.0, 0.85]</li>
</ul>
<p>Server sees: [0.4, 0.0, 0.85] ← Cannot recover original [0.5, -0.3, 0.8]
But after aggregating all clients, secrets cancel and server gets correct sum.</p>
</div>




  <a id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_MaskUpdate_" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.MaskUpdate*"></a>

  <h3 id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_MaskUpdate_System_Int32_System_Collections_Generic_Dictionary_System_String__0____System_Double_" data-uid="AiDotNet.FederatedLearning.Privacy.SecureAggregation`1.MaskUpdate(System.Int32,System.Collections.Generic.Dictionary{System.String,`0[]},System.Double)">
  MaskUpdate(int, Dictionary&lt;string, T[]&gt;, double)
  <a class="header-action link-secondary" title="View source" href="https://github.com/ooples/AiDotNet/blob/master/src/FederatedLearning/Privacy/SecureAggregation.cs/#L233"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Masks a client's model update with pairwise secrets, applying the client's aggregation weight before masking.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public Dictionary&lt;string, T[]&gt; MaskUpdate(int clientId, Dictionary&lt;string, T[]&gt; clientUpdate, double clientWeight)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>clientId</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The ID of the client whose update to mask.</p>
</dd>
    <dt><code>clientUpdate</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.dictionary-2">Dictionary</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>, T[]&gt;</dt>
    <dd><p>The client's (unweighted) model update.</p>
</dd>
    <dt><code>clientWeight</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>The aggregation weight to apply to this client's update (e.g., sample count).</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.dictionary-2">Dictionary</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>, T[]&gt;</dt>
    <dd><p>The masked (and weighted) model update.</p>
</dd>
  </dl>







  <h4 class="section" id="AiDotNet_FederatedLearning_Privacy_SecureAggregation_1_MaskUpdate_System_Int32_System_Collections_Generic_Dictionary_System_String__0____System_Double__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>For secure weighted averaging, clients must apply weights to their updates <i>before</i> masking so secrets still cancel.
This overload multiplies the update by <code class="paramref">clientWeight</code> and then adds the pairwise masks.</p>
</div>





</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ooples/AiDotNet/blob/master/src/FederatedLearning/Privacy/SecureAggregation.cs/#L74" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          AiDotNet - Enterprise AI/ML Library for .NET
        </div>
      </div>
    </footer>
  </body>
</html>
